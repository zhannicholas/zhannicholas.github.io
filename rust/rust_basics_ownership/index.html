<!doctype html><html lang=zh-cn dir=auto><head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="æ‰€æœ‰æƒï¼ˆownershipï¼‰ æ˜¯ Rust ç‹¬ä¸€æ— äºŒçš„åŠŸèƒ½ï¼Œä¹Ÿæ˜¯ Rust ä¸­çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ã€‚Rust ä¸éœ€è¦å¼€å‘è€…æ‰‹åŠ¨å›æ”¶å†…å­˜ï¼Œä¹Ÿæ²¡æœ‰åƒåœ¾æ”¶é›†å™¨ï¼Œä½†å®ƒè¿˜èƒ½ä¿è¯å†…å­˜">
<meta name=theme-color content="#ffcd00">
<meta property="og:title" content="Rust åŸºç¡€ï¼šæ‰€æœ‰æƒ â€¢ Nicholas Zhan">
<meta property="og:description" content="æ‰€æœ‰æƒï¼ˆownershipï¼‰ æ˜¯ Rust ç‹¬ä¸€æ— äºŒçš„åŠŸèƒ½ï¼Œä¹Ÿæ˜¯ Rust ä¸­çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ã€‚Rust ä¸éœ€è¦å¼€å‘è€…æ‰‹åŠ¨å›æ”¶å†…å­˜ï¼Œä¹Ÿæ²¡æœ‰åƒåœ¾æ”¶é›†å™¨ï¼Œä½†å®ƒè¿˜èƒ½ä¿è¯å†…å­˜">
<meta property="og:url" content="https://zhannicholas.github.io/rust/rust_basics_ownership/">
<meta property="og:site_name" content="Nicholas Zhan">
<meta property="og:type" content="article"><meta property="og:image" content="https://www.gravatar.com/avatar/85f2cc2a45fd9533b91a65214224f9d7?s=256"><meta property="article:section" content="rust"><meta property="article:tag" content="Rust"><meta property="article:published_time" content="2021-09-25T10:51:29+08:00"><meta property="article:modified_time" content="2021-09-25T10:51:29+08:00"><meta name=twitter:card content="summary">
<meta name=generator content="Hugo 0.90.1">
<title>Rust åŸºç¡€ï¼šæ‰€æœ‰æƒ â€¢ Nicholas Zhan</title>
<link rel=canonical href=https://zhannicholas.github.io/rust/rust_basics_ownership/>
<link rel=icon href=/favicon.ico>
<link rel=stylesheet href=/assets/css/main.ab98e12b.css><link rel=stylesheet href=/css/custom.css><style>:root{--color-accent:#ffcd00}</style>
</head>
<body class="page type-rust has-sidebar">
<div class=site><div id=sidebar class=sidebar>
<a class=screen-reader-text href=#main-menu>è·³åˆ°ä¸»èœå•</a>
<div class=container><section class="widget widget-about sep-after">
<header>
<div class=logo>
<a href=/>
<img src=/images/logo.png>
</a>
</div>
<h2 class="title site-title">
<a href=/>
Nicholas Zhan
</a>
</h2>
<div class=desc>
Java Developer, Runner, Cyclist
</div>
</header>
</section>
<section class="widget widget-search sep-after">
<header>
<h4 class="title widget-title">æœç´¢</h4>
</header>
<form action=/search id=search-form class=search-form>
<label>
<span class=screen-reader-text>æœç´¢</span>
<input id=search-term class=search-term type=search name=q placeholder=æœç´¢&mldr;>
</label></form>
</section>
<section class="widget widget-sidebar_menu sep-after"><nav id=sidebar-menu class="menu sidebar-menu" aria-label=ä¾§è¾¹æ èœå•>
<div class=container>
<ul><li class="item has-children">
<a href=/java/>Java</a><button class=sub-menu-toggler>
<span class=screen-reader-text>expand sub menu</span>
<span class=sign></span>
</button>
<ul class=sub-menu><li class=item>
<a href=/java/jakartaee/>Jakarta EE</a></li><li class=item>
<a href=/java/jvm/>JVM</a></li><li class=item>
<a href=/java/concurrency/>å¹¶å‘</a></li></ul></li><li class="item has-current">
<a href=/rust/>Rust</a></li><li class=item>
<a href=/distributed_computing/>åˆ†å¸ƒå¼è®¡ç®—</a></li><li class=item>
<a href=/operating_systems/>æ“ä½œç³»ç»Ÿ</a></li><li class="item has-children">
<a href=/computer_networks/>è®¡ç®—æœºç½‘ç»œ</a><button class=sub-menu-toggler>
<span class=screen-reader-text>expand sub menu</span>
<span class=sign></span>
</button>
<ul class=sub-menu><li class=item>
<a href=/computer_networks/http/>HTTP</a></li><li class=item>
<a href=/computer_networks/fundamentals/>åŸºç¡€çŸ¥è¯†</a></li></ul></li></ul>
</div>
</nav>
</section><section class="widget widget-taxonomy_cloud sep-after">
<header>
<h4 class="title widget-title">æ ‡ç­¾</h4>
</header>
<div class="container list-container">
<ul class="list taxonomy-cloud"><li>
<a href=/tags/communication/ style=font-size:1em>Communication</a>
</li><li>
<a href=/tags/c%E7%AE%97%E6%B3%95/ style=font-size:1.2380952380952381em>Cç®—æ³•</a>
</li><li>
<a href=/tags/english/ style=font-size:1em>English</a>
</li><li>
<a href=/tags/gc/ style=font-size:1.0952380952380953em>GC</a>
</li><li>
<a href=/tags/git/ style=font-size:1em>Git</a>
</li><li>
<a href=/tags/http/ style=font-size:1.3333333333333333em>HTTP</a>
</li><li>
<a href=/tags/hugo/ style=font-size:1em>Hugo</a>
</li><li>
<a href=/tags/jakartaee/ style=font-size:1.0952380952380953em>JakartaEE</a>
</li><li>
<a href=/tags/java/ style=font-size:2em>Java</a>
</li><li>
<a href=/tags/jdbc/ style=font-size:1em>JDBC</a>
</li><li>
<a href=/tags/jvm/ style=font-size:1.1428571428571428em>JVM</a>
</li><li>
<a href=/tags/leetcode/ style=font-size:1.0952380952380953em>Leetcode</a>
</li><li>
<a href=/tags/life/ style=font-size:1em>Life</a>
</li><li>
<a href=/tags/linux/ style=font-size:1.1428571428571428em>Linux</a>
</li><li>
<a href=/tags/mybatis/ style=font-size:1em>MyBatis</a>
</li><li>
<a href=/tags/networks/ style=font-size:1.0952380952380953em>Networks</a>
</li><li>
<a href=/tags/os/ style=font-size:1.2857142857142856em>OS</a>
</li><li>
<a href=/tags/ostep/ style=font-size:1.0952380952380953em>OSTEP</a>
</li><li>
<a href=/tags/python/ style=font-size:1em>Python</a>
</li><li>
<a href=/tags/redis/ style=font-size:1.3333333333333333em>Redis</a>
</li><li>
<a href=/tags/rpc/ style=font-size:1em>RPC</a>
</li><li>
<a href=/tags/rust/ style=font-size:1.3333333333333333em>Rust</a>
</li><li>
<a href=/tags/shell/ style=font-size:1.2380952380952381em>Shell</a>
</li><li>
<a href=/tags/sicp/ style=font-size:1em>SICP</a>
</li><li>
<a href=/tags/spring/ style=font-size:1em>Spring</a>
</li><li>
<a href=/tags/spring-boot/ style=font-size:1em>Spring Boot</a>
</li><li>
<a href=/tags/tomcat/ style=font-size:1em>Tomcat</a>
</li><li>
<a href=/tags/zookeeper/ style=font-size:1em>ZooKeeper</a>
</li><li>
<a href=/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%A1%E7%AE%97/ style=font-size:1.0476190476190477em>åˆ†å¸ƒå¼è®¡ç®—</a>
</li><li>
<a href=/tags/%E5%A4%9A%E5%A4%84%E7%90%86%E5%99%A8%E7%BC%96%E7%A8%8B%E7%9A%84%E8%89%BA%E6%9C%AF/ style=font-size:1.0476190476190477em>å¤šå¤„ç†å™¨ç¼–ç¨‹çš„è‰ºæœ¯</a>
</li><li>
<a href=/tags/%E5%B7%A5%E7%A8%8B%E6%80%9D%E7%BB%B4/ style=font-size:1em>å·¥ç¨‹æ€ç»´</a>
</li><li>
<a href=/tags/%E5%B9%B6%E5%8F%91/ style=font-size:1.2857142857142856em>å¹¶å‘</a>
</li><li>
<a href=/tags/%E6%90%9C%E7%B4%A2/ style=font-size:1em>æœç´¢</a>
</li><li>
<a href=/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/ style=font-size:1.0476190476190477em>æ•°æ®åº“</a>
</li><li>
<a href=/tags/%E6%B8%B8%E8%AE%B0/ style=font-size:1em>æ¸¸è®°</a>
</li><li>
<a href=/tags/%E7%8E%B0%E4%BB%A3%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ style=font-size:1.0476190476190477em>ç°ä»£æ“ä½œç³»ç»Ÿ</a>
</li><li>
<a href=/tags/%E7%94%9F%E4%BA%A7%E8%80%85%E6%B6%88%E8%B4%B9%E8%80%85/ style=font-size:1em>ç”Ÿäº§è€…æ¶ˆè´¹è€…</a>
</li><li>
<a href=/tags/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/ style=font-size:1.1428571428571428em>ç®—æ³•å¯¼è®º</a>
</li><li>
<a href=/tags/%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/ style=font-size:1em>è®¾è®¡åŸåˆ™</a>
</li><li>
<a href=/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/ style=font-size:1.5714285714285714em>è®¾è®¡æ¨¡å¼</a>
</li></ul>
</div>
</section>
</div>
<div class=sidebar-overlay></div>
</div><div class=main><nav id=main-menu class="menu main-menu" aria-label=ä¸»èœå•>
<div class=container>
<a class=screen-reader-text href=#content>è·³åˆ°å†…å®¹</a>
<button id=sidebar-toggler class=sidebar-toggler aria-controls=sidebar>
<span class=screen-reader-text>Toggle Sidebar</span>
<span class=open><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
</span>
<span class=close><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
</span>
</button>
<ul><li class=item>
<a href=/>ä¸»é¡µ</a>
</li><li class=item>
<a href=/posts/>åšå®¢</a>
</li><li class=item>
<a href=/notebook/>ç¬”è®°æœ¬</a>
</li><li class=item>
<a href=/itinerary/>æ¸¸å±±ç©æ°´</a>
</li></ul>
</div>
</nav><div class=header-widgets>
<div class=container>
<style>.widget-breadcrumbs li:after{content:'\2f '}</style>
<section class="widget widget-breadcrumbs sep-after">
<nav id=breadcrumbs>
<ol><li><a href=/>ä¸»é¡µ</a></li><li><a href=/rust/>Rust</a></li><li><span>Rust åŸºç¡€ï¼šæ‰€æœ‰æƒ</span></li></ol>
</nav>
</section></div>
</div>
<header id=header class="header site-header">
<div class="container sep-after">
<div class=header-info><p class="site-title title">Nicholas Zhan</p><p class="desc site-desc">Java Developer, Runner, Cyclist</p>
</div>
</div>
</header>
<main id=content>
<article lang=zh-cn class=entry>
<header class="header entry-header">
<div class="container sep-after">
<div class=header-info>
<h1 class=title>Rust åŸºç¡€ï¼šæ‰€æœ‰æƒ</h1>
</div>
<div class=entry-meta>
<span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
<span class=screen-reader-text>Posted on </span>
<time class=entry-date datetime=2021-09-25T10:51:29+08:00>2021, Sep 25</time>
</span>
<span class=byline><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M21 21V20c0-2.76-4-5-9-5s-9 2.24-9 5v1"/><path d="M16 6.37A4 4 0 1112.63 3 4 4 0 0116 6.37z"/></svg>
<span class=screen-reader-text> by </span><a href=/authors/zhannicholas>Nicholas Zhan</a></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>
11 mins read
</span>
</div>
</div>
</header>
<details class="container entry-toc">
<summary class=title>
<span>ç›®å½•</span>
</summary>
<nav id=TableOfContents>
<ul>
<li><a href=#æ ˆä¸å †>æ ˆä¸å †</a></li>
<li><a href=#æ‰€æœ‰æƒè§„åˆ™>æ‰€æœ‰æƒè§„åˆ™</a></li>
<li><a href=#å˜é‡ä¸æ•°æ®çš„äº¤äº’æ–¹å¼>å˜é‡ä¸æ•°æ®çš„äº¤äº’æ–¹å¼</a>
<ul>
<li><a href=#ç§»åŠ¨move>ç§»åŠ¨ï¼ˆMoveï¼‰</a></li>
<li><a href=#å…‹éš†clone>å…‹éš†ï¼ˆCloneï¼‰</a></li>
<li><a href=#æ ˆä¸Šæ•°æ®çš„å¤åˆ¶copy>æ ˆä¸Šæ•°æ®çš„å¤åˆ¶ï¼ˆCopyï¼‰</a></li>
</ul>
</li>
<li><a href=#æ‰€æœ‰æƒä¸å‡½æ•°>æ‰€æœ‰æƒä¸å‡½æ•°</a></li>
<li><a href=#å¼•ç”¨>å¼•ç”¨</a>
<ul>
<li><a href=#å¯å˜å¼•ç”¨>å¯å˜å¼•ç”¨</a></li>
</ul>
</li>
<li><a href=#åˆ‡ç‰‡slice>åˆ‡ç‰‡ï¼ˆSliceï¼‰</a>
<ul>
<li><a href=#å­—ç¬¦ä¸²åˆ‡ç‰‡>å­—ç¬¦ä¸²åˆ‡ç‰‡</a></li>
<li><a href=#å…¶å®ƒç±»å‹çš„åˆ‡ç‰‡>å…¶å®ƒç±»å‹çš„åˆ‡ç‰‡</a></li>
</ul>
</li>
<li><a href=#å‚è€ƒèµ„æ–™>å‚è€ƒèµ„æ–™</a></li>
</ul>
</nav>
</details>
<div class="container entry-content">
<p><strong>æ‰€æœ‰æƒï¼ˆownershipï¼‰</strong> æ˜¯ Rust ç‹¬ä¸€æ— äºŒçš„åŠŸèƒ½ï¼Œä¹Ÿæ˜¯ Rust ä¸­çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ã€‚Rust ä¸éœ€è¦å¼€å‘è€…æ‰‹åŠ¨å›æ”¶å†…å­˜ï¼Œä¹Ÿæ²¡æœ‰åƒåœ¾æ”¶é›†å™¨ï¼Œä½†å®ƒè¿˜èƒ½ä¿è¯å†…å­˜å®‰å…¨ï¼Œè¿™å°±æ˜¯æ‰€æœ‰æƒçš„å¼ºå¤§ä¹‹å¤„ã€‚</p>
<p>åœ¨ Rust ä¸­ï¼Œå†…å­˜çš„ç®¡ç†æ˜¯é€šè¿‡æ‰€æœ‰æƒç³»ç»Ÿï¼ˆownership systemï¼‰è¿›è¡Œçš„ï¼Œç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘æ—¶æ ¹æ®ä¸€ç³»åˆ—çš„è§„åˆ™è¿›è¡Œæ£€æŸ¥ã€‚æ›´åŠ ä»¤äººèµå¹çš„æ˜¯ï¼Œæ‰€æœ‰æƒç³»ç»Ÿä¸­çš„ä»»ä½•åŠŸèƒ½éƒ½ä¸ä¼šå‡æ…¢ç¨‹åºçš„è¿è¡Œé€Ÿåº¦ï¼</p>
<h2 id=æ ˆä¸å †>æ ˆä¸å †</h2>
<p>åœ¨å¼€å§‹å­¦ä¹ æ‰€æœ‰æƒè¿™ä¸ªæ¦‚å¿µä¹‹å‰ï¼Œæˆ‘ä»¬æœ‰å¿…è¦å…ˆå›é¡¾ä¸€ä¸‹æ•°æ®åœ¨å†…å­˜ä¸­çš„å­˜æ”¾å½¢å¼ã€‚åœ¨ Rust ä¸­ï¼Œæ•°æ®è¢«å­˜æ”¾åœ¨æ ˆï¼ˆstackï¼‰æˆ–å †ï¼ˆheapï¼‰ä¸­ã€‚</p>
<p>æ ˆä¸å †ç»„ç»‡æ•°æ®çš„æ–¹å¼ä¸åŒã€‚åœ¨æ ˆä¸­ï¼Œæ•°æ®æ—¶å…ˆå…¥åå‡ºï¼ˆFILOï¼‰çš„ï¼Œå³æœ€åå­˜å…¥çš„æ•°æ®æœ€å…ˆè¢«ä½¿ç”¨ã€‚è€Œåœ¨å †ä¸­ï¼Œæ•°æ®çš„ä½¿ç”¨å°±æ²¡æœ‰é¡ºåºè¦æ±‚ï¼Œæ•°æ®åœ¨å †ä¸­çš„ç»„ç»‡æƒ…å†µæ¯”æ ˆä¸­è¦å·®å¾ˆå¤šã€‚æ­¤å¤–ï¼Œå­˜æ”¾åœ¨æ ˆä¸­çš„æ•°æ®å ç”¨çš„ç©ºé—´å¿…é¡»æ˜¯ <strong>ç¼–è¯‘æœŸé—´å·²çŸ¥ä¸”å›ºå®šçš„</strong>ï¼Œå¯¹äºé‚£äº›å¤§å°ä¸å›ºå®šæˆ–ç¼–è¯‘æ—¶æ— æ³•çŸ¥é“å¤§å°çš„æ•°æ®ï¼Œåº”å½“è¢«å­˜æ”¾åœ¨å †ä¸Šã€‚åœ¨æˆ‘ä»¬å¾€å †ä¸­å­˜æ•°æ®æ—¶ï¼Œå†…å­˜åˆ†é…å™¨ä¼šä»å †ä¸­æ‰¾å‡ºä¸€å—å¤§å°åˆé€‚çš„å†…å­˜ç©ºé—´ï¼Œæ ‡è®°å…¶å·²ä½¿ç”¨ï¼Œç„¶åè¿”å›ç»™æˆ‘ä»¬ä¸€ä¸ªæŒ‡å‘åˆ†é…åœ°å€çš„æŒ‡é’ˆï¼Œåç»­æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæŒ‡é’ˆè®¿é—®å †ä¸­çš„æ•°æ®ã€‚è¿™ä¸ªæŒ‡é’ˆä¼šè¢«å­˜å‚¨åœ¨æ ˆä¸Šï¼Œå› ä¸ºå®ƒçš„å¤§å°æ˜¯å›ºå®šä¸”å·²çŸ¥çš„ã€‚</p>
<p>å°†æ•°æ®å­˜å‚¨åœ¨æ ˆä¸Šçš„é€Ÿåº¦è¦å¿«äºå­˜å‚¨åœ¨å †ä¸Šçš„é€Ÿåº¦ã€‚å› ä¸ºå½“æ•°æ®è¢«æ”¾åœ¨æ ˆä¸Šæ—¶ï¼Œå†…å­˜åˆ†é…å™¨ä¸éœ€è¦ä¸ºæ–°æ•°æ®æ‰¾å‡ºä¸€å—ç©ºé—²ç©ºé—´ï¼Œæ•°æ®æ€»æ˜¯è¢«æ”¾åœ¨æ ˆé¡¶ã€‚å¦‚æœæ•°æ®è¦è¢«æ”¾åˆ°å †ä¸Šï¼Œå†…å­˜åˆ†é…å™¨ä¸ä»…éœ€è¦ä»å †ä¸­æ‰¾å‡ºä¸€å—åˆé€‚çš„ç©ºé—²ç©ºé—´ï¼Œè¿˜éœ€è¦é˜²æ­¢è¿™å—ç©ºé—´è¢«å…¶å®ƒæ•°æ®æŠ¢å ã€‚ç±»ä¼¼åœ°ï¼Œè®¿é—®æ ˆä¸Šæ•°æ®çš„é€Ÿåº¦è¦å¿«äºè®¿é—®å †ä¸Šæ•°æ®çš„é€Ÿåº¦ã€‚å› ä¸ºå †ä¸Šçš„æ•°æ®éœ€è¦é€šè¿‡æ ˆä¸Šçš„æŒ‡é’ˆæ‰èƒ½å®šä½åˆ°ï¼Œè¿™æ¯”æ ˆä¸Šçš„æ•°æ®å¤šäº†ä¸€æ¬¡å†…å­˜è®¿é—®ã€‚</p>
<p>å½“æˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œä¼ é€’ç»™å‡½æ•°çš„å€¼ï¼ˆæˆ–æŒ‡å‘å †ä¸­æ•°æ®çš„æŒ‡é’ˆï¼‰å’Œå‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡éƒ½æ˜¯å­˜æ”¾åœ¨æ ˆä¸Šçš„ã€‚å½“å‡½æ•°è°ƒç”¨ç»“æŸåï¼Œè¿™äº›å€¼éƒ½ä¼šä»æ ˆä¸­å¼¹å‡ºã€‚</p>
<p>è®²äº†è¿™ä¹ˆå¤šï¼Œç°åœ¨è¯¥æ‰€æœ‰æƒå‡ºåœºäº†ã€‚æ‰€æœ‰æƒè´Ÿè´£ <strong>è·Ÿè¸ªå“ªéƒ¨åˆ†ä»£ç æ­£åœ¨ä½¿ç”¨å †ä¸­çš„å“ªéƒ¨åˆ†æ•°æ®ï¼Œæœ€å¤§é™åº¦åœ°å‡å°‘å †ä¸­çš„é‡å¤æ•°æ®ï¼Œæ¸…ç†å †ä¸­æœªä½¿ç”¨çš„æ•°æ®ï¼Œé˜²æ­¢å†…å­˜ç©ºé—´è¢«è€—å°½</strong>ã€‚ç®€å•æ¥è¯´ï¼Œæ‰€æœ‰æƒç®¡ç†ç€å †ä¸­çš„æ•°æ®ã€‚</p>
<p>é‚£ä¹ˆï¼ŒRust ä¸­çš„å“ªäº›æ•°æ®ä¼šè¢«åˆ†é…åœ¨å †ä¸Šå‘¢ï¼Ÿç­”æ¡ˆæ˜¯é‚£äº›å¤§å°åœ¨ç¼–è¯‘æœŸé—´ä¸å¯çŸ¥æˆ–è€…å¤§å°ä¸å›ºå®šçš„æ•°æ®ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²ç±»å‹ï¼ˆ<code>String</code>ï¼‰ã€‚æ ‡é‡ç±»å‹ï¼ˆæ•´å‹ã€æµ®ç‚¹å‹ã€å¸ƒå°”ç±»å‹å’Œå­—ç¬¦ç±»å‹ï¼‰æˆ–å¤åˆç±»å‹ï¼ˆå…ƒç»„å’Œæ•°ç»„ï¼‰çš„æ•°æ®éƒ½æ˜¯å­˜æ”¾åœ¨æ ˆä¸Šçš„ï¼Œä½œç”¨åŸŸç»“æŸæ—¶å°±ä¼šè¢«ä»æ ˆä¸Šå¼¹å‡ºã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå­—ç¬¦ä¸²ç±»å‹ï¼ˆ<code>String</code>ï¼‰å’Œå­—ç¬¦ä¸²å­—é¢é‡ï¼ˆstring literalï¼‰æ˜¯ä¸åŒçš„ã€‚å­—ç¬¦ä¸²å­—é¢é‡ï¼ˆæ¯”å¦‚ <code>let s = "hello, world";</code>ï¼‰æ˜¯ä»£ç ä¸­ç¡¬ç¼–ç çš„ï¼ˆç¼–è¯‘æ—¶å¤§å°å·²çŸ¥ï¼‰ã€ä¸å¯å˜çš„ï¼Œè€Œå­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®è¢«å­˜å‚¨åœ¨å †ä¸Šï¼Œå­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®æ˜¯å¯å˜çš„ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>String</code> çš„ <code>from</code> å‡½æ•°ä»å­—ç¬¦ä¸²å­—é¢é‡åˆ›å»ºä¸€ä¸ª <code>String</code> ç±»å‹çš„å˜é‡ï¼Œæ¯”å¦‚ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> s <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;hello&#34;</span>);
    s.push_str(<span style=color:#e6db74>&#34;, world!&#34;</span>); <span style=color:#75715e>// push_str() appends a literal to a String
</span><span style=color:#75715e></span>    println!(<span style=color:#e6db74>&#34;{}&#34;</span>, s); <span style=color:#75715e>// This will print `hello, world!`
</span><span style=color:#75715e></span>}
</code></pre></div><h2 id=æ‰€æœ‰æƒè§„åˆ™>æ‰€æœ‰æƒè§„åˆ™</h2>
<p>æ‰€æœ‰æƒçš„è§„åˆ™å¦‚ä¸‹ï¼Œå®ƒä»¬ä¸å¯è¢«è¿åï¼š</p>
<ul>
<li>Rust ä¸­çš„æ¯ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ªå˜é‡ï¼Œè¿™ä¸ªå˜é‡å°±æ˜¯è¿™ä¸ªå€¼çš„ <strong>æ‰€æœ‰è€…ï¼ˆownerï¼‰</strong></li>
<li>æ¯ä¸ªå€¼åœ¨åŒä¸€æ—¶åˆ»æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ‰€æœ‰è€…</li>
<li>å½“æ‰€æœ‰è€…ï¼ˆå˜é‡ï¼‰è¶…å‡ºä½œç”¨åŸŸï¼ˆscopeï¼‰ï¼Œå€¼å°±ä¼šè¢«ä¸¢å¼ƒï¼ˆdropï¼‰ï¼Œå€¼å æ®çš„å†…å­˜è¢«å½’è¿˜</li>
</ul>
<p>å˜é‡åœ¨è¿›å…¥ä½œç”¨åŸŸåå¼€å§‹ç”Ÿæ•ˆï¼Œæ­¤åï¼Œå˜é‡åœ¨è¶…å‡ºä½œç”¨åŸŸä¹‹å‰ä¸€ç›´éƒ½æ˜¯æœ‰æ•ˆçš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
    { <span style=color:#75715e>// s is not valid here, itâ€™s not yet declared
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>let</span> s <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;hello&#34;</span>;   <span style=color:#75715e>// s is valid from this point forward
</span><span style=color:#75715e></span>
        <span style=color:#75715e>// do stuff with s
</span><span style=color:#75715e></span>    }  <span style=color:#75715e>// this scope is now over, and s is no longer valid
</span><span style=color:#75715e></span>}
</code></pre></div><p>å®é™…ä¸Šï¼Œå½“å˜é‡è¶…å‡ºä½œç”¨åŸŸæ—¶ï¼ŒRust ä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªå« <code>drop</code> çš„ç‰¹æ®Šå‡½æ•°è¿›è¡Œå†…å­˜çš„å½’è¿˜ã€‚åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>drop</code> ä¼šåœ¨ç¬¬ä¸€ä¸ª <code>}</code> å¤„è¢«è°ƒç”¨ã€‚</p>
<h2 id=å˜é‡ä¸æ•°æ®çš„äº¤äº’æ–¹å¼>å˜é‡ä¸æ•°æ®çš„äº¤äº’æ–¹å¼</h2>
<p>åœ¨ Rust ä¸­ï¼Œå¤šä¸ªå˜é‡å¯ä»¥ä»¥ä¸åŒçš„æ–¹å¼ä¸åŒä¸€ä»½æ•°æ®è¿›è¡Œäº¤äº’ï¼Œæœ€å¸¸è§çš„äº¤äº’æ–¹å¼æœ‰ç§»åŠ¨ï¼ˆmoveï¼‰å’Œå…‹éš†ï¼ˆcloneï¼‰ã€‚</p>
<h3 id=ç§»åŠ¨move>ç§»åŠ¨ï¼ˆMoveï¼‰</h3>
<p>å…ˆæ¥çœ‹ä¸€æ®µç®€å•çš„ä»£ç ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
    <span style=color:#66d9ef>let</span> x <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>;
    <span style=color:#66d9ef>let</span> y <span style=color:#f92672>=</span> x;
    println!(<span style=color:#e6db74>&#34;x = {}, y = {}.&#34;</span>, x, y);
}
</code></pre></div><p>è¿™æ®µä»£ç å¾ˆç®€å•ï¼Œä¹Ÿèƒ½é€šè¿‡ç¼–è¯‘ï¼Œæœ€ç»ˆè¿è¡Œä¼šæ‰“å°å‡ºç»“æœ <code>x = 5, y = 5.</code>ã€‚å¦‚æœå°† <code>let x = 5;</code> ä¿®æ”¹ä¸º <code>let x = "5";</code>ï¼Œä»ç„¶èƒ½å¾—åˆ°ä¸€æ ·çš„è¿è¡Œç»“æœã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘å°† <code>let x = 5;</code> ä¿®æ”¹æˆ <code>let x = String::from("5");</code>ï¼Œç¼–è¯‘éƒ½è¿‡ä¸å»äº†ğŸ˜‚ã€‚æˆ‘å¹¶æ²¡æœ‰æ”¹åŠ¨ä»£ç çš„ç»“æ„ï¼Œå”¯ä¸€æ”¹å˜çš„åªæœ‰å˜é‡ <code>x</code> çš„ç±»å‹ï¼Œè¿™é‡Œé¢åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼ŸğŸ¤”</p>
<p>è¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ Rust ä¸­ <code>String</code> åœ¨å†…å­˜ä¸­çš„å­˜å‚¨å½¢å¼ã€‚ä¸ºäº†èƒ½å¤Ÿä½¿ç”¨å®˜æ–¹çš„å›¾ï¼Œè®©æˆ‘å°†ä»£ç ä¿®æ”¹ä¸ºå®˜æ–¹çš„ä»£ç ğŸ˜ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
    <span style=color:#66d9ef>let</span> s1 <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;hello&#34;</span>);
    <span style=color:#66d9ef>let</span> s2 <span style=color:#f92672>=</span> s1;
    println!(<span style=color:#e6db74>&#34;s1 = {}, s2 = {}&#34;</span>, s1, s2);
}
</code></pre></div><p>åœ¨ Rust ä¸­ï¼Œ<code>String</code> ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šæŒ‡å‘å­—ç¬¦ä¸²å®é™…å†…å®¹çš„æŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡ã€‚å®ƒä»¬å­˜æ”¾åœ¨æ ˆä¸Šï¼Œå¯¹åº”ä¸‹å›¾ä¸­çš„å·¦ä¾§éƒ¨åˆ†ï¼Œå­—ç¬¦ä¸²çš„å®é™…å†…å®¹åˆ™å­˜æ”¾åœ¨å †ä¸Šï¼Œå¯¹åº”ä¸‹å›¾ä¸­çš„å³ä¾§éƒ¨åˆ†ï¼š</p>
<p><img src=/images/rust/trpl04-01.svg alt></p>
<p>å½“å˜é‡ <code>s1</code> è¢«èµ‹å€¼ç»™ <code>s2</code> åï¼Œå­—ç¬¦ä¸² <code>s1</code> åœ¨æ ˆä¸Šçš„æ•°æ®è¢«å¤åˆ¶äº†ä¸€ä»½ç»™ <code>s2</code> ç”¨ï¼Œè€Œå †ä¸Šçš„å†…å®¹æ²¡æœ‰è¢«å¤åˆ¶ï¼š</p>
<p><img src=/images/rust/trpl04-02.svg alt></p>
<p>è¿™ä¸ªè¿‡ç¨‹ä¼¼æ›¾ç›¸è¯†ï¼Œå®ƒå°±åƒ Java ä¸­çš„æµ…æ‹·è´ï¼ˆshallow copyï¼‰ä¸€æ ·ã€‚åœ¨ï¼ŒRust ä¸­ï¼Œå®é™…çš„è¿‡ç¨‹ä¸å®Œå…¨æ˜¯è¿™æ ·ï¼Œå› ä¸ºå½“ <code>s1</code> å’Œ <code>s2</code> éƒ½è¶…å‡ºä½œç”¨åŸŸæ—¶ï¼Œæ˜¾ç„¶ä¸åº”è¯¥å½’è¿˜ä¸¤æ¬¡å†…å­˜ã€‚Rust ä¸ºäº†ä¿è¯å†…å­˜å®‰å…¨ï¼Œå¹¶æ²¡æœ‰è¿›è¡Œå¤åˆ¶æ“ä½œï¼Œè€Œæ˜¯åœ¨åœ¨æ‰§è¡Œ <code>let s2 = s1;</code> ä¹‹åä½¿ <code>s1</code> å¤±æ•ˆã€‚è¿™æ ·ï¼Œå½“ <code>s1</code> è¶…å‡ºä½œç”¨åŸŸæ—¶ï¼ŒRust å°±ä¸éœ€è¦å› ä¸ºå®ƒé‡Šæ”¾ä»»ä½•å†…å­˜äº†ã€‚è®© <code>s1</code> å¤±æ•ˆçš„æ“ä½œåœ¨ Rust ä¸­è¢«ç§°ä¸º <strong>ç§»åŠ¨ï¼ˆmoveï¼‰</strong>ï¼Œ<code>let s2 = s1;</code> çš„å®é™…ä½œç”¨æ˜¯è®© <code>s1</code> ç§»åŠ¨åˆ° <code>s2</code>ã€‚æ‰€ä»¥ï¼Œæ­£ç¡®çš„å›¾æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š</p>
<p><img src=/images/rust/trpl04-04.svg alt></p>
<p>è¿™å°±æ˜¯ä¸Šé¢ä»£ç ç¼–è¯‘å¤±è´¥çš„åŸå› ï¼Œè¿™ä¸‹åº”è¯¥èƒ½çœ‹æ‡‚ç¼–è¯‘å™¨ç»™å‡ºçš„ä¿¡æ¯äº†ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell>&gt; cargo run
   Compiling ownership v0.1.0 (F:\Code\Rust\rust-study\ownership)
warning<span style=color:#960050;background-color:#1e0010>:</span> unused variable<span style=color:#960050;background-color:#1e0010>:</span> `s2`
 --&gt; src\main.rs<span style=color:#960050;background-color:#1e0010>:</span>3<span style=color:#960050;background-color:#1e0010>:</span>9
  |
3 |     let s2 = s1;
  |         ^^ help<span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#66d9ef>if</span> this is intentional, prefix it with an underscore<span style=color:#960050;background-color:#1e0010>:</span> `_s2`
  |
  = note<span style=color:#960050;background-color:#1e0010>:</span> `<span style=color:#75715e>#[warn(unused_variables)]` on by default</span>

error<span style=color:#66d9ef>[E0382]</span><span style=color:#960050;background-color:#1e0010>:</span> borrow of moved value<span style=color:#960050;background-color:#1e0010>:</span> `s1`
 --&gt; src\main.rs<span style=color:#960050;background-color:#1e0010>:</span>4<span style=color:#960050;background-color:#1e0010>:</span>28
  |
2 |     let s1 = String::from(<span style=color:#e6db74>&#34;hello&#34;</span>);
  |         -- move occurs because `s1` has type `String`, which does not implement the `Copy` trait
  |              -- value moved here
4 |     println!(<span style=color:#e6db74>&#34;{}, world!&#34;</span>, s1);
  |                            ^^ value borrowed here after move

error<span style=color:#960050;background-color:#1e0010>:</span> aborting due to previous error; 1 warning emitted

<span style=color:#66d9ef>For</span> more information about this error, <span style=color:#66d9ef>try</span> `rustc --explain E0382`.
error<span style=color:#960050;background-color:#1e0010>:</span> could not compile `ownership`

To learn more, run the command again with --verbose.
F:\Code\Rust\rust-study\ownership [master +4 ~0 -0 !]&gt; cargo run
   Compiling ownership v0.1.0 (F:\Code\Rust\rust-study\ownership)
error<span style=color:#66d9ef>[E0382]</span><span style=color:#960050;background-color:#1e0010>:</span> borrow of moved value<span style=color:#960050;background-color:#1e0010>:</span> `s1`
 --&gt; src\main.rs<span style=color:#960050;background-color:#1e0010>:</span>4<span style=color:#960050;background-color:#1e0010>:</span>34
  |
2 |     let s1 = String::from(<span style=color:#e6db74>&#34;hello&#34;</span>);
  |         -- move occurs because `s1` has type `String`, which does not implement the `Copy` trait
3 |     let s2 = s1;
  |              -- value moved here
4 |     println!(<span style=color:#e6db74>&#34;s1 = {}, s2 = {}&#34;</span>, s1, s2);
  |                                  ^^ value borrowed here after move

error<span style=color:#960050;background-color:#1e0010>:</span> aborting due to previous error

<span style=color:#66d9ef>For</span> more information about this error, <span style=color:#66d9ef>try</span> `rustc --explain E0382`.
error<span style=color:#960050;background-color:#1e0010>:</span> could not compile `ownership`

To learn more, run the command again with --verbose.
</code></pre></div><h3 id=å…‹éš†clone>å…‹éš†ï¼ˆCloneï¼‰</h3>
<p>Rust ä¸ä¼šè‡ªåŠ¨è¿›è¡Œæ•°æ®çš„æ·±æ‹·è´ï¼ˆdeep copyï¼‰ï¼Œå› ä¸ºæ·±æ‹·è´ä¼šå¯¹ç¨‹åºçš„æ€§èƒ½é€ æˆå¾ˆå¤§çš„å½±å“ã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ› Rust è¿›è¡Œæ•°æ®çš„æ·±æ‹·è´ï¼Œéœ€è¦ä½¿ç”¨ <code>clone</code> æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
    <span style=color:#66d9ef>let</span> s1 <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;hello&#34;</span>);
    <span style=color:#66d9ef>let</span> s2 <span style=color:#f92672>=</span> s1.clone();
    println!(<span style=color:#e6db74>&#34;s1 = {}, s2 = {}&#34;</span>, s1, s2);
}
</code></pre></div><p>è¿™æ ·ä¸€æ¥ï¼Œ<code>s1</code> å’Œ <code>s2</code> æ¶‰åŠçš„æ•°æ®å°±æ˜¯ä¸‹å›¾ä¸­å±•ç¤ºçš„è¿™æ ·äº†ï¼š</p>
<p><img src=/images/rust/trpl04-03.svg alt></p>
<h3 id=æ ˆä¸Šæ•°æ®çš„å¤åˆ¶copy>æ ˆä¸Šæ•°æ®çš„å¤åˆ¶ï¼ˆCopyï¼‰</h3>
<p>ç°åœ¨æ¥æ€è€ƒä¸ºå•¥ <code>let x = 5;</code> æˆ– <code>let x = "5";</code>æ—¶ä»£ç èƒ½å¤Ÿæ­£å¸¸è¿è¡Œã€‚è¿™æ˜¯å› ä¸º <code>5</code> å’Œ <code>"5"</code> çš„å¤§å°éƒ½æ˜¯å›ºå®šçš„ï¼Œç¨‹åºç¼–è¯‘æ—¶å°±å¯ä»¥çŸ¥é“å®ƒä»¬çš„å¤§å°ï¼Œæ‰€ä»¥æ•°æ®è¢«åˆ†é…åœ¨äº†æ ˆä¸Šã€‚è€Œ <strong>Rust å¯¹æ ˆä¸Šæ•°æ®çš„å¤åˆ¶é‡‡å–çš„æ˜¯æ·±æ‹·è´</strong>ï¼Œæ·±æ‹·è´å°±ä¸å­˜åœ¨ç§»åŠ¨äº†ã€‚</p>
<p>è¿˜è®°å¾—ç¼–è¯‘é”™è¯¯â€œmove occurs because <code>s1</code> has type <code>String</code>, which does not implement the <code>Copy</code> traitâ€å—ï¼ŸRust ä¸­æœ‰ä¸€ä¸ªç‰¹æ®Šçš„æ³¨è§£å«åš <strong><code>Copy</code></strong>ã€‚å¦‚æœæŸç§æ•°æ®ç±»å‹å®ç°äº† <code>Copy</code>ï¼Œæ—§å˜é‡åœ¨èµ‹å€¼ä¹‹åä»ç„¶æ˜¯å¯ä»¥ä½¿ç”¨çš„ã€‚æ­¤å¤–ï¼ŒRust ä¸­è¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šçš„æ³¨è§£å«åš <strong><code>Drop</code></strong>ï¼Œå®ƒä¼šåœ¨å˜é‡è¶…å‡ºä½œç”¨åŸŸååšäº›äº‹æƒ…ã€‚Rust ä¸å…è®¸æˆ‘ä»¬å°† <code>Copy</code> æ”¾åœ¨äº†å®ç°äº†<code>Drop</code> çš„ç±»å‹ä¸Šï¼Œå¦‚æœæˆ‘ä»¬è¿™ä¹ˆåšï¼Œç¼–è¯‘ä¼šå¤±è´¥ã€‚</p>
<p>é‚£ä¹ˆï¼Œå“ªäº›ç±»å‹å®ç°äº† <code>Copy</code> å‘¢ï¼Ÿè¯´å®è¯ï¼Œæœ‰ç‚¹å¤šï¼Œå…·ä½“çš„å†…å®¹å¯ä»¥æŸ¥çœ‹ <a href=https://doc.rust-lang.org/std/marker/trait.Copy.html#>Trait Copy</a>ã€‚ä½ ä¼šå‘ç°ï¼Œæ‰€æœ‰çš„æ ‡é‡ç±»å‹éƒ½å®ç°äº† <code>Copy</code>ã€‚</p>
<h2 id=æ‰€æœ‰æƒä¸å‡½æ•°>æ‰€æœ‰æƒä¸å‡½æ•°</h2>
<p>ä¼ é€’å˜é‡ç»™å‡½æ•°æ—¶æ‰€æœ‰æƒçš„å˜åŒ–ä¸å˜é‡èµ‹å€¼ä¸€æ ·ã€‚æ ¹æ®æ•°æ®ç±»å‹çš„ä¸åŒï¼Œå¯èƒ½å‘ç”Ÿç§»åŠ¨ï¼ˆä¸¢å¤±æ‰€æœ‰æƒï¼‰æˆ–å¤åˆ¶ï¼Œä¸‹é¢ä¾‹å­ä¸­çš„æ³¨é‡Šè§£é‡Šå¾—éå¸¸æ¸…æ¥šï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
    <span style=color:#66d9ef>let</span> s <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;hello&#34;</span>);  <span style=color:#75715e>// s comes into scope
</span><span style=color:#75715e></span>
    takes_ownership(s);             <span style=color:#75715e>// s&#39;s value moves into the function...
</span><span style=color:#75715e></span>                                    <span style=color:#75715e>// ... and so is no longer valid here
</span><span style=color:#75715e></span>
    <span style=color:#66d9ef>let</span> x <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>;                      <span style=color:#75715e>// x comes into scope
</span><span style=color:#75715e></span>
    makes_copy(x);                  <span style=color:#75715e>// x would move into the function,
</span><span style=color:#75715e></span>                                    <span style=color:#75715e>// but i32 is Copy, so it&#39;s okay to still
</span><span style=color:#75715e></span>                                    <span style=color:#75715e>// use x afterward
</span><span style=color:#75715e></span>
} <span style=color:#75715e>// Here, x goes out of scope, then s. But because s&#39;s value was moved, nothing
</span><span style=color:#75715e></span>  <span style=color:#75715e>// special happens.
</span><span style=color:#75715e></span>
<span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>takes_ownership</span>(some_string: String) { <span style=color:#75715e>// some_string comes into scope
</span><span style=color:#75715e></span>    println!(<span style=color:#e6db74>&#34;{}&#34;</span>, some_string);
} <span style=color:#75715e>// Here, some_string goes out of scope and `drop` is called. The backing
</span><span style=color:#75715e></span>  <span style=color:#75715e>// memory is freed.
</span><span style=color:#75715e></span>
<span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>makes_copy</span>(some_integer: <span style=color:#66d9ef>i32</span>) { <span style=color:#75715e>// some_integer comes into scope
</span><span style=color:#75715e></span>    println!(<span style=color:#e6db74>&#34;{}&#34;</span>, some_integer);
} <span style=color:#75715e>// Here, some_integer goes out of scope. Nothing special happens.
</span></code></pre></div><p>å¦‚æœå‡½æ•°å¸¦è¿”å›å€¼å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™æ‰€æœ‰æƒä¹Ÿä¼šå‘ç”Ÿè½¬ç§»ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
    <span style=color:#66d9ef>let</span> s1 <span style=color:#f92672>=</span> gives_ownership();         <span style=color:#75715e>// gives_ownership moves its return value into s1
</span><span style=color:#75715e></span>
    <span style=color:#66d9ef>let</span> s2 <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;hello&#34;</span>);     <span style=color:#75715e>// s2 comes into scope
</span><span style=color:#75715e></span>
    <span style=color:#66d9ef>let</span> s3 <span style=color:#f92672>=</span> takes_and_gives_back(s2);  <span style=color:#75715e>// s2 is moved into takes_and_gives_back, which also
</span><span style=color:#75715e></span>                                        <span style=color:#75715e>// moves its return value into s3
</span><span style=color:#75715e></span>} <span style=color:#75715e>// Here, s3 goes out of scope and is dropped. s2 goes out of scope but was
</span><span style=color:#75715e></span>  <span style=color:#75715e>// moved, so nothing happens. s1 goes out of scope and is dropped.
</span><span style=color:#75715e></span>
<span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>gives_ownership</span>() -&gt; String {             <span style=color:#75715e>// gives_ownership will move its
</span><span style=color:#75715e></span>                                             <span style=color:#75715e>// return value into the function that calls it
</span><span style=color:#75715e></span>
    <span style=color:#66d9ef>let</span> some_string <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;hello&#34;</span>); <span style=color:#75715e>// some_string comes into scope
</span><span style=color:#75715e></span>
    some_string                              <span style=color:#75715e>// some_string is returned and moves out to the calling function
</span><span style=color:#75715e></span>}

<span style=color:#75715e>// takes_and_gives_back will take a String and return one
</span><span style=color:#75715e></span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>takes_and_gives_back</span>(a_string: String) -&gt; String { <span style=color:#75715e>// a_string comes into scope
</span><span style=color:#75715e></span>    a_string  <span style=color:#75715e>// a_string is returned and moves out to the calling function
</span><span style=color:#75715e></span>}
</code></pre></div><h2 id=å¼•ç”¨>å¼•ç”¨</h2>
<p>å¦‚æœæ¯æ¬¡éƒ½è¿›è¡Œ <code>takes_and_gives_back</code> è¿™ç§å¤ºå–æ‰€æœ‰æƒè€Œååˆå½’è¿˜æ‰€æœ‰æƒçš„æ“ä½œï¼Œæœªå…ä¹Ÿå¤ªè¿‡ç¹çã€‚å¹¸è¿çš„æ˜¯ï¼ŒRust ä¸ºæˆ‘ä»¬æä¾›äº† <strong>å¼•ç”¨ï¼ˆreferenceï¼‰</strong>ï¼Œå®ƒå¯ä»¥æ¶ˆé™¤ <code>takes_and_gives_bakc</code> çš„å°´å°¬ä¹‹å¤„ã€‚</p>
<p>ä¸‹é¢æ˜¯ä½¿ç”¨å¼•ç”¨çš„ä¸€ä¸ªä¾‹å­ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
    <span style=color:#66d9ef>let</span> s1 <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;hello&#34;</span>);
    <span style=color:#66d9ef>let</span> len <span style=color:#f92672>=</span> calculate_length(<span style=color:#f92672>&amp;</span>s1);
    println!(<span style=color:#e6db74>&#34;The length of &#39;{}&#39; is {}.&#34;</span>, s1, len);
}

<span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>calculate_length</span>(s: <span style=color:#66d9ef>&amp;</span>String) -&gt; <span style=color:#66d9ef>usize</span> {  <span style=color:#75715e>// s is a reference to a String
</span><span style=color:#75715e></span>    s.len()
} <span style=color:#75715e>// Here, s goes out of scope. But because it does not have ownership of what it refers to, nothing happens.
</span></code></pre></div><p>å¼•ç”¨å…è®¸æˆ‘ä»¬å¼•ç”¨æŸä¸ªå˜é‡ï¼Œè€Œä¸ä¼šå¤ºå–å˜é‡å¯¹æ•°æ®çš„æ‰€æœ‰æƒã€‚å¼•ç”¨ç›¸å…³çš„æ“ä½œç¬¦æ˜¯ <code>&</code>ï¼Œä¸ä¹‹ç›¸åçš„æ“ä½œå«è§£å¼•ç”¨ï¼ˆdereferencingï¼‰ï¼Œæ“ä½œç¬¦æ˜¯ <code>*</code>ã€‚åœ¨ä»¥ä¸Šä»£ç ä¸­ï¼Œ<code>&s1</code> åˆ›å»ºäº†ä¸€ä¸ªæŒ‡å‘ <code>s1</code> çš„å¼•ç”¨ï¼Œ<code>s1</code> ä¾ç„¶æŒæœ‰å­—ç¬¦ä¸² <code>"hello"</code> çš„æ‰€æœ‰æƒã€‚</p>
<p><img src=/images/rust/trpl04-05.svg alt></p>
<p>ç”±äº <code>&s1</code> ä¸å…·æœ‰æ•°æ®çš„æ‰€æœ‰æƒï¼Œæ‰€ä»¥å½“ <code>&s1</code> è¶…å‡ºä½œç”¨åŸŸæ—¶ï¼Œæ•°æ®ä¸ä¼šè¢«ä¸¢å¼ƒã€‚Rust å°†å¼•ç”¨ä½œä¸ºå‡½æ•°å‚æ•°çš„æ“ä½œç§°ä¸º <strong>å€Ÿç”¨ï¼ˆborrowingï¼‰</strong>ï¼Œè¿™æœ‰ç‚¹åƒç°å®ç”Ÿæ´»ä¸­åˆ«äººå€Ÿäº†æˆ‘ä»¬çš„ä¸œè¥¿åˆå½’è¿˜ä¸€æ ·ï¼Œæ‰€æœ‰æƒä¸ä¼šè½¬ç§»ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒRust æ˜¯ä¸å…è®¸æˆ‘ä»¬ä¿®æ”¹å€Ÿç”¨çš„æ•°æ®çš„ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
    <span style=color:#66d9ef>let</span> s <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;hello&#34;</span>);
    change(<span style=color:#f92672>&amp;</span>s);
}

<span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>change</span>(some_string: <span style=color:#66d9ef>&amp;</span>String) {
    some_string.push_str(<span style=color:#e6db74>&#34;, world&#34;</span>);
}
</code></pre></div><p>ä»¥ä¸Šä»£ç ä¼šç¼–è¯‘å¤±è´¥ï¼Œå¹¶ä¸”ç¼–è¯‘å™¨ä¼šå‘Šè¯‰æˆ‘ä»¬é”™è¯¯åŸå› ï¼Œå¹¶ç»™å‡ºæ­£ç¡®çš„ä¿®æ”¹å»ºè®®ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell>&gt; cargo run
   Compiling ownership v0.1.0 (F:\Code\Rust\rust-study\ownership)
error<span style=color:#66d9ef>[E0596]</span><span style=color:#960050;background-color:#1e0010>:</span> cannot borrow `*some_string` as mutable, as it is behind a `&amp;` reference
 --&gt; src\main.rs<span style=color:#960050;background-color:#1e0010>:</span>7<span style=color:#960050;background-color:#1e0010>:</span>5
  |
6 | fn change(some_string<span style=color:#960050;background-color:#1e0010>:</span> &amp;String) {
  |                        ------- help<span style=color:#960050;background-color:#1e0010>:</span> consider changing this to be a mutable reference<span style=color:#960050;background-color:#1e0010>:</span> `&amp;mut String`
7 |     some_string.push_str(<span style=color:#e6db74>&#34;, world&#34;</span>);
  |     ^^^^^^^^^^^ `some_string` is a `&amp;` reference, so the data it refers to cannot be borrowed as mutable

error<span style=color:#960050;background-color:#1e0010>:</span> aborting due to previous error

<span style=color:#66d9ef>For</span> more information about this error, <span style=color:#66d9ef>try</span> `rustc --explain E0596`.
error<span style=color:#960050;background-color:#1e0010>:</span> could not compile `ownership`

To learn more, run the command again with --verbose.
</code></pre></div><h3 id=å¯å˜å¼•ç”¨>å¯å˜å¼•ç”¨</h3>
<p>åœ¨ä¸Šé¢çš„é”™è¯¯ä¸­ï¼Œç¼–è¯‘å™¨å»ºè®®æˆ‘ä»¬å°† <code>change</code> å‡½æ•°çš„å‚æ•°ç”± <code>&String</code> ä¿®æ”¹ä¸º <code>&mut String</code>ï¼Œå³ä»ä¸å¯å˜å¼•ç”¨ï¼ˆimmutable referenceï¼‰ä¿®æ”¹ä¸ºå¯å˜å¼•ç”¨ï¼ˆmutable referenceï¼‰ã€‚è¿™æ“ä½œå’Œæ™®é€šå˜é‡çš„å¯å˜ä¸ä¸å¯å˜ç±»ä¼¼ã€‚æ­£ç¡®çš„ä»£ç åº”è¯¥æ˜¯ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> s <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;hello&#34;</span>);
    change(<span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> s);
}

<span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>change</span>(some_string: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>mut</span> String) {
    some_string.push_str(<span style=color:#e6db74>&#34;, world&#34;</span>);
}
</code></pre></div><p>è¿™é‡Œè¿›è¡Œäº†ä¸‰å¤„ä¿®æ”¹ï¼šé¦–å…ˆå°† <code>s</code> æ”¹ä¸ºå¯å˜çš„ <code>mut s</code>ï¼Œç„¶åæ˜¯ä¼ é€’ç»™ <code>change</code> çš„å‚æ•°ä¿®æ”¹ä¸º <code>&mut s</code>ï¼Œæœ€åæ˜¯ <code>change</code> å‡½æ•°çš„å®šä¹‰ä¿®æ”¹ä¸º <code>&mut String</code>ï¼Œä¸‰è€…ç¼ºä¸€ä¸å¯ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¯å˜å¼•ç”¨æœ‰ä¸€ä¸ªéå¸¸å¤§çš„é™åˆ¶ï¼š<strong>åŒä¸€æ—¶åˆ»ï¼ŒåŒä¸€æ•°æ®çš„å¯å˜å¼•ç”¨åªèƒ½æœ‰ä¸€ä¸ªï¼Œè€Œä¸å¯å˜å¼•ç”¨å´å¯ä»¥æœ‰å¤šä¸ª</strong>ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç ä¼šç¼–è¯‘å¤±è´¥ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> s <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;hello&#34;</span>);
    <span style=color:#66d9ef>let</span> r1 <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> s;
    <span style=color:#66d9ef>let</span> r2 <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> s;
    println!(<span style=color:#e6db74>&#34;{}, {}&#34;</span>, r1, r2);
}
</code></pre></div><p>ç¼–è¯‘å™¨ç®€å•æ˜äº†åœ°æŒ‡å‡ºäº†æˆ‘çš„é”™è¯¯ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell>&gt; cargo run
   Compiling ownership v0.1.0 (F:\Code\Rust\rust-study\ownership)
error<span style=color:#66d9ef>[E0499]</span><span style=color:#960050;background-color:#1e0010>:</span> cannot borrow `s` as mutable more than once at a time
 --&gt; src\main.rs<span style=color:#960050;background-color:#1e0010>:</span>4<span style=color:#960050;background-color:#1e0010>:</span>14
  |
3 |     let r1 = &amp;mut s;
  |              ------ first mutable borrow occurs here
4 |     let r2 = &amp;mut s;
  |              ^^^^^^ second mutable borrow occurs here
5 |     println!(<span style=color:#e6db74>&#34;{}, {}&#34;</span>, r1, r2);
  |                        -- first borrow later used here

error<span style=color:#960050;background-color:#1e0010>:</span> aborting due to previous error

<span style=color:#66d9ef>For</span> more information about this error, <span style=color:#66d9ef>try</span> `rustc --explain E0499`.
error<span style=color:#960050;background-color:#1e0010>:</span> could not compile `ownership`

To learn more, run the command again with --verbose.
</code></pre></div><p>Rust è¿™ä¹ˆåšçš„åŸå› æ˜¯ä¸ºäº†é˜²æ­¢ç¼–è¯‘æœŸé—´çš„æ•°æ®ç«äº‰ï¼ˆå’Œ Java å¹¶å‘ä¸­çš„æ•°æ®ç«äº‰ç±»ä¼¼ï¼‰ã€‚æ•°æ®ç«äº‰ä¼šå¯¼è‡´ç¨‹åºçš„è¡Œä¸ºè¶…å‡ºé¢„æœŸï¼ŒåŠ å¤§è¿è¡Œæ—¶è¯Šæ–­é—®é¢˜çš„éš¾åº¦ã€‚</p>
<p>é‚£ä¹ˆåº”è¯¥å¦‚ä½•ä¿®æ”¹ä¸Šé¢æœ‰é—®é¢˜çš„ä»£ç å‘¢ï¼Ÿæ‹†åˆ†ä¸¤ä¸ªå˜é‡çš„ä½œç”¨åŸŸå³å¯ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> s <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;hello&#34;</span>);
    {
      <span style=color:#66d9ef>let</span> r1 <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> s;
    }
    <span style=color:#66d9ef>let</span> r2 <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> s;
    println!(<span style=color:#e6db74>&#34;{}, {}&#34;</span>, r1, r2);
}
</code></pre></div><p><strong>åœ¨ Rust ä¸­ï¼Œå¼•ç”¨çš„ä½œç”¨åŸŸä»å£°æ˜å¼€å§‹ï¼Œç»“æŸäºå¼•ç”¨æœ€åä¸€æ¬¡è¢«ä½¿ç”¨</strong>ã€‚Rust ä¸å…è®¸åŒä¸€ä»½æ•°æ®åœ¨ä¸€ä¸ªä½œç”¨åŸŸå†…åŒæ—¶å‡ºç°å¯å˜å¼•ç”¨å’Œä¸å¯å˜å¼•ç”¨çš„æƒ…å†µã€‚ä¾‹å¦‚ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> s <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;hello&#34;</span>);

    <span style=color:#66d9ef>let</span> r1 <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>s; <span style=color:#75715e>// no problem
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> r2 <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>s; <span style=color:#75715e>// no problem
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> r3 <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> s; <span style=color:#75715e>// BIG PROBLEM
</span><span style=color:#75715e></span>
    println!(<span style=color:#e6db74>&#34;{}, {}, and {}&#34;</span>, r1, r2, r3);
}
</code></pre></div><p>ä¼šå‡ºç°ä»¥ä¸‹ç¼–è¯‘é”™è¯¯ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell>&gt; cargo run  
   Compiling ownership v0.1.0 (F:\Code\Rust\rust-study\ownership)
error<span style=color:#66d9ef>[E0502]</span><span style=color:#960050;background-color:#1e0010>:</span> cannot borrow `s` as mutable because it is also borrowed as immutable
 --&gt; src\main.rs<span style=color:#960050;background-color:#1e0010>:</span>5<span style=color:#960050;background-color:#1e0010>:</span>14
  |
3 |     let r1 = &amp;s; // no problem
  |              -- immutable borrow occurs here
4 |     let r2 = &amp;s; // no problem
5 |     let r3 = &amp;mut s; // BIG PROBLEM
  |              ^^^^^^ mutable borrow occurs here
6 |     println!(<span style=color:#e6db74>&#34;{}, {}, and {}&#34;</span>, r1, r2, r3);
  |                                -- immutable borrow later used here

error<span style=color:#960050;background-color:#1e0010>:</span> aborting due to previous error

<span style=color:#66d9ef>For</span> more information about this error, <span style=color:#66d9ef>try</span> `rustc --explain E0502`.
error<span style=color:#960050;background-color:#1e0010>:</span> could not compile `ownership`

To learn more, run the command again with --verbose.
</code></pre></div><p>ä½†å¦‚æœæˆ‘å°†ä»£ç ä¿®æ”¹ä¸ºï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> s <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;hello&#34;</span>);
    <span style=color:#66d9ef>let</span> r1 <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>s; <span style=color:#75715e>// no problem
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> r2 <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>s; <span style=color:#75715e>// no problem
</span><span style=color:#75715e></span>    println!(<span style=color:#e6db74>&#34;{} and {}&#34;</span>, r1, r2);
    <span style=color:#75715e>// variables r1 and r2 will not be used after this point
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> r3 <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> s; <span style=color:#75715e>// no problem
</span><span style=color:#75715e></span>    println!(<span style=color:#e6db74>&#34;{}&#34;</span>, r3);
}
</code></pre></div><p>ç¨‹åºå°±èƒ½é€šè¿‡ç¼–è¯‘å¹¶æ­£å¸¸è¿è¡Œã€‚è¿™æ˜¯å› ä¸ºï¼Œ<code>r3</code> è¢«å£°æ˜ä¹‹å‰ï¼Œ<code>r1</code> å’Œ <code>r2</code> çš„ä½œç”¨åŸŸå·²ç»ç»“æŸäº†ï¼Œä¸å­˜åœ¨ä½œç”¨åŸŸçš„é‡å ã€‚</p>
<h2 id=åˆ‡ç‰‡slice>åˆ‡ç‰‡ï¼ˆSliceï¼‰</h2>
<p>åˆ‡ç‰‡ï¼ˆsliceï¼‰å…è®¸æˆ‘ä»¬å¼•ç”¨é›†åˆä¸­çš„ä¸€æ®µè¿ç»­å…ƒç´ ï¼Œå®ƒæ˜¯ä¸€ç§æ²¡æœ‰æ‰€æœ‰æƒçš„æ•°æ®ç±»å‹ã€‚</p>
<h3 id=å­—ç¬¦ä¸²åˆ‡ç‰‡>å­—ç¬¦ä¸²åˆ‡ç‰‡</h3>
<p>å­—ç¬¦ä¸²åˆ‡ç‰‡ï¼ˆstring sliceï¼‰æ˜¯ä¸€ä¸ªæŒ‡å‘ <code>String</code> ä¸­çš„ä¸€éƒ¨åˆ†å†…å®¹çš„å¼•ç”¨ï¼Œè¿™éƒ¨åˆ†å†…å®¹æ˜¯åŸå­—ç¬¦ä¸²çš„ä¸€ä¸ªå­ä¸²ã€‚ä¾‹å¦‚ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
    <span style=color:#66d9ef>let</span> s <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;hello world&#34;</span>);
    <span style=color:#66d9ef>let</span> hello <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>s[<span style=color:#ae81ff>0</span><span style=color:#f92672>..</span><span style=color:#ae81ff>5</span>];   <span style=color:#75715e>// hello
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> world <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>s[<span style=color:#ae81ff>6</span><span style=color:#f92672>..</span><span style=color:#ae81ff>11</span>];  <span style=color:#75715e>// world
</span><span style=color:#75715e></span>    println!(<span style=color:#e6db74>&#34;{}, {}&#34;</span>, hello, world); <span style=color:#75715e>// hello, world
</span><span style=color:#75715e></span>}
</code></pre></div><p>åœ¨ä¸Šé¢è¿™æ®µä»£ç ä¸­ï¼Œ<code>hello</code> å’Œ <code>world</code> éƒ½åªå¼•ç”¨äº† <code>s</code> ä¸­çš„ä¸€éƒ¨åˆ†ï¼š</p>
<p><img src=/images/rust/trpl04-06.svg alt></p>
<p>å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹åœ¨ Rust ä¸­ç”¨ <code>&str</code> è¡¨ç¤ºï¼Œå®ƒæ¯” <code>String</code> æ›´åŠ çµæ´»ã€‚å› ä¸º <code>&str</code> ä¸ä»…å¯ä»¥å¼•ç”¨ <code>String</code> çš„ä¸€éƒ¨åˆ†ï¼Œè¿˜èƒ½å¼•ç”¨ <code>String</code> çš„æ‰€æœ‰å†…å®¹ã€‚åˆ©ç”¨ <code>&str</code>ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™è·å–å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªå•è¯çš„å‡½æ•°ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>first_word</span>(s: <span style=color:#66d9ef>&amp;</span>String) -&gt; <span style=color:#66d9ef>&amp;</span><span style=color:#66d9ef>str</span> {
    <span style=color:#66d9ef>let</span> bytes <span style=color:#f92672>=</span> s.as_bytes();

    <span style=color:#66d9ef>for</span> (i, <span style=color:#f92672>&amp;</span>item) <span style=color:#66d9ef>in</span> bytes.iter().enumerate() {
        <span style=color:#66d9ef>if</span> item <span style=color:#f92672>==</span> <span style=color:#e6db74>b&#39; &#39;</span> {
            <span style=color:#66d9ef>return</span> <span style=color:#f92672>&amp;</span>s[<span style=color:#ae81ff>0</span><span style=color:#f92672>..</span>i];
        }
    }
    <span style=color:#f92672>&amp;</span>s[<span style=color:#f92672>..</span>]
}
</code></pre></div><p>ç°åœ¨å¯ä»¥æ¥å›ç­”ä¸ºå•¥å­—ç¬¦ä¸²å­—é¢é‡æ˜¯ä¸å¯å˜çš„è¿™ä¸ªé—®é¢˜äº†ã€‚å› ä¸ºå­—ç¬¦ä¸²å­—é¢é‡çš„æ•°æ®ç±»å‹æ˜¯ <code>&str</code>ï¼Œè€Œ <code>&str</code> æ˜¯ä¸å¯å˜å¼•ç”¨ã€‚</p>
<h3 id=å…¶å®ƒç±»å‹çš„åˆ‡ç‰‡>å…¶å®ƒç±»å‹çš„åˆ‡ç‰‡</h3>
<p>é™¤äº†å­—ç¬¦ä¸²åˆ‡ç‰‡ï¼ˆ<code>&str</code>ï¼‰ï¼ŒRust ä¸­è¿˜æœ‰å¾ˆå¤šå…¶å®ƒç±»å‹çš„åˆ‡ç‰‡ï¼Œæ¯”å¦‚æ•°ç»„çš„åˆ‡ç‰‡ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust>
<span style=color:#75715e>#![allow(unused)]</span>
<span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
<span style=color:#66d9ef>let</span> a <span style=color:#f92672>=</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>];
<span style=color:#66d9ef>let</span> slice <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>a[<span style=color:#ae81ff>1</span><span style=color:#f92672>..</span><span style=color:#ae81ff>3</span>];
assert_eq!(slice, <span style=color:#f92672>&amp;</span>[<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>]);
}
</code></pre></div><p>åœ¨ä»¥ä¸Šä»£ç ä¸­ï¼Œ<code>slice</code> æ˜¯æ•°ç»„ <code>a</code> çš„åˆ‡ç‰‡ï¼Œå®ƒçš„æ•°æ®ç±»å‹æ˜¯ <code>&[int32]</code>ã€‚</p>
<h2 id=å‚è€ƒèµ„æ–™>å‚è€ƒèµ„æ–™</h2>
<ol>
<li>Steve Klabnik, Carol Nichols. <a href=https://doc.rust-lang.org/stable/book/>The Rust Programming Language</a>.</li>
</ol>
</div>
<footer class=entry-footer>
<div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg>
<span class=screen-reader-text>åˆ†ç±»: </span><a class=category href=/categories/rust/>Rust</a></div>
<div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=screen-reader-text>æ ‡ç­¾: </span><a class=tag href=/tags/rust/>Rust</a></div>
</div>
</footer>
</article>
<nav class=entry-nav>
<div class=container><div class="prev-entry sep-before">
<a href=/rust/rust_basics_control_flow/>
<span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>
Previous</span>
<span class=screen-reader-text>ä¸Šä¸€ç¯‡: </span>Rust åŸºç¡€ï¼šæ§åˆ¶æµ</a>
</div><div class="next-entry sep-before">
<a href=/rust/rust_basics_struct/>
<span class=screen-reader-text>ä¸‹ä¸€ç¯‡: </span>Rust åŸºç¡€ï¼šç»“æ„ä½“<span aria-hidden=true>ä¸‹ä¸€ä¸ª<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg>
</span>
</a>
</div></div>
</nav>
</main>
<footer id=footer class=footer>
<div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label=ç¤¾äº¤èœå•>
<ul><li>
<a href=https://github.com/zhannicholas target=_blank rel="noopener me">
<span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
</a>
</li><li>
<a href=https://t.me/zhannicholas target=_blank rel="noopener me">
<span class=screen-reader-text>Open Telegram account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M23.91 3.79 20.3 20.84c-.25 1.21-.98 1.5-2 .94l-5.5-4.07-2.66 2.57c-.3.3-.55.56-1.1.56-.72.0-.6-.27-.84-.95L6.3 13.7.85 12c-1.18-.35-1.19-1.16.26-1.75l21.26-8.2c.97-.43 1.9.24 1.53 1.73z"/></svg>
</a>
</li><li>
<a href=mailto:zhan_nicholas@outlook.com target=_blank rel="noopener me">
<span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
</a>
</li><li>
<a href=https://linkedin.com/in/%e4%bc%9f%e4%bc%9f-%e8%a9%b9-27871a104 target=_blank rel="noopener me">
<span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
</a>
</li></ul>
</nav>
</section><div class=copyright>
<p> &copy; 2018-2021 Nicholas Zhan </p>
</div>
</div>
</footer>
</div>
</div><script>window.__assets_js_src="/assets/js/"</script>
<script src=/assets/js/main.c3bcf2df.js></script><script src=/js/custom.js></script>
</body>
</html>