<!doctype html><html lang=zh-cn><head><meta http-equiv=content-type content="text/html" charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon type=image/png sizes=96x96 href=https://zhannicholas.github.io/favicon/favicon-96x96.png><link rel=icon type=image/png sizes=32x32 href=https://zhannicholas.github.io/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://zhannicholas.github.io/favicon/favicon-16x16.png><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title itemprop=name>Bash | NZ's Digital Garden</title><meta name=description content><meta property="og:title" content="Bash | NZ's Digital Garden"><meta name=twitter:title content="Bash | NZ's Digital Garden"><meta itemprop=name content="Bash | NZ's Digital Garden"><meta name=application-name content="Bash | NZ's Digital Garden"><meta property="og:site_name" content><meta property="og:type" content="website"><meta property="og:title" content="NZ's Digital Garden"><meta property="og:description" content><meta property="og:site_name" content="NZ's Digital Garden"><meta property="og:url" content="https://zhannicholas.github.io/pages/bash/"><meta property="og:locale" content="en"><meta property="og:image" content="/"><meta property="og:image:secure_url" content="https://zhannicholas.github.io"><meta property="og:type" content="website"><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><link rel=preconnect href=https://fonts.googleapis.com><link rel=stylesheet href="/css/style.min.8458c1237ecc4766957580cbadcdbc3827551cb1e8f51d9fa5c37d7473a022e9.css" integrity="sha256-hFjBI37MR2aVdYDLrc28OCdVHLHo9R2fpcN9dHOgIuk="></head><body class="bg-zinc-100 dark:bg-gray-800"><div class="top-0 z-50 w-full text-gray-200 bg-gray-900 border-2 border-gray-900 md:sticky border-b-stone-200/10"><div x-data="{ open: false }" class="flex flex-col max-w-full px-4 mx-auto md:items-center md:justify-between md:flex-row md:px-6 lg:px-8"><div class="flex flex-row items-center justify-between p-4"><a href=https://zhannicholas.github.io/ class="flex text-gray-100 transition duration-1000 ease-in-out group"><div class="mt-1 text-xl font-black tracking-tight text-gray-100 uppercase transition-colors group-hover:text-gray-400/60">NZ's Digital Garden</div></a><button class="rounded-lg md:hidden focus:outline-none focus:shadow-outline" @click="open = !open" role=navigation aria-expanded=false aria-label=Main aria-controls=menuItems><svg fill="currentcolor" viewBox="0 0 20 20" class="w-6 h-6"><path x-show="!open" fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4A1 1 0 013 5zm0 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm6 5a1 1 0 011-1h6a1 1 0 110 2h-6a1 1 0 01-1-1z" clip-rule="evenodd"/><path x-show="open" fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414.0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/></svg></button></div><nav :class="{'flex': open, 'hidden': !open}" class="flex-col flex-grow hidden pb-4 md:pb-0 md:flex md:justify-end md:flex-row"><div @click.away="open = false" class=relative x-data="{ open: false }"><button @click="open = !open" class="flex flex-row items-center w-full px-4 py-2 mt-2 text-sm font-semibold text-left bg-transparent rounded-lg md:w-auto md:inline md:mt-0 md:ml-4 hover:text-white focus:text-white hover:bg-primary-600 focus:bg-primary-600 focus:outline-none focus:shadow-outline">
<span>The Garden</span><svg fill="currentcolor" viewBox="0 0 20 20" :class="{'rotate-180': open, 'rotate-0': !open}" class="inline w-4 h-4 mt-1 ml-1 transition-transform duration-200 transform md:-mt-1"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414.0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414.0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/></svg></button><div x-show=open x-transition:enter="transition ease-out duration-100" x-transition:enter-start="transform opacity-0 scale-95" x-transition:enter-end="transform opacity-100 scale-100" x-transition:leave="transition ease-in duration-75" x-transition:leave-start="transform opacity-100 scale-100" x-transition:leave-end="transform opacity-0 scale-95" class="absolute right-0 z-30 w-full mt-2 origin-top-right rounded-md shadow-lg md:w-48"><div class="px-2 py-2 text-primary-900 bg-white rounded-md shadow"><a class="block px-4 py-2 mt-2 text-sm font-semibold bg-transparent rounded-lg md:mt-0 hover:text-white focus:text-white hover:bg-primary-600 focus:bg-primary-600 focus:outline-none focus:shadow-outline" href=https://zhannicholas.github.io/posts>Posts</a>
<a class="block px-4 py-2 mt-2 text-sm font-semibold bg-transparent rounded-lg md:mt-0 hover:text-white focus:text-white hover:bg-primary-600 focus:bg-primary-600 focus:outline-none focus:shadow-outline" href=https://zhannicholas.github.io/pages>Notes</a>
<a class="block px-4 py-2 mt-2 text-sm font-semibold bg-transparent rounded-lg md:mt-0 hover:text-white focus:text-white hover:bg-primary-600 focus:bg-primary-700 focus:outline-none focus:shadow-outline" href=https://zhannicholas.github.io/library>Library</a></div></div></div><a class="px-4 py-2 mt-2 text-sm font-semibold rounded-lg md:mt-0 md:ml-4 hover:text-white focus:text-white hover:bg-primary-600 focus:bg-primary-700 focus:outline-none focus:shadow-outline" href=https://zhannicholas.github.io/now>Now</a>
<a class="px-4 py-2 mt-2 text-sm font-semibold bg-transparent rounded-lg md:mt-0 md:ml-4 hover:text-white focus:text-white hover:bg-primary-600 focus:bg-primary-700 focus:outline-none focus:shadow-outline" href=https://zhannicholas.github.io/about>About</a>
<button id=theme-toggle type=button class="p-2 text-sm text-gray-500 rounded-lg md: dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 md:ml-2 max-w-5 xs:hidden"><svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentcolor" viewBox="0 0 20 20" aria-label="Dark or Light Mode" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></nav></div></div><div class=content><article><header class="max-w-2xl mx-auto mb-4 bg-primary-600"><span class=py-96><h1 class="px-6 pt-6 pb-16 mx-auto dark:prose-invert text-5xl font-black text-center text-white capitalize">Bash</h1></span></header><div class="max-w-4xl mx-auto mt-8 mb-2"><div class=px-6></div></div><div class="fixed z-20 top-[3.8125rem] bottom-0 right-[max(0px,calc(50%-45rem))] w-[18rem] py-10 overflow-y-auto hidden xl:block"><nav><div class="flex items-center"><h2 class="pl-2 my-0 text-xl font-medium text-zinc-800 uppercase break-words">Table of Contents</h2></div><div class="absolute top-auto bottom-auto right-auto p-0 -left-4" role=menu><div class="relative z-50 max-w-sm m-4 overflow-hidden shadow-lg"><ul class="relative p-4 overflow-x-hidden overflow-y-auto overscroll-y-auto overscroll-x-auto"><li><a class="px-2 text-left text-zinc-700 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#bash-%e4%b8%8e-bash-%e8%84%9a%e6%9c%ac>Bash 与 Bash 脚本</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#shell>Shell</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#bash>Bash</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#bash--%e5%90%af%e5%8a%a8%e6%97%b6%e5%8a%a0%e8%bd%bd%e7%9a%84%e6%96%87%e4%bb%b6>Bash 启动时加载的文件</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#invoked-as-an-interactive-login-shell--or-with---login><em>Invoked as an interactive login shell</em> <em>，</em> <em>or with <code>--login</code></em></a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#invoked-as-an-interactive-non-login-shell><em>Invoked as an interactive non-login shell</em></a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#invoked-non-interactively><em>Invoked non-interactively</em></a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#invoked-with-the-sh-command><em>Invoked with the sh command</em></a></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%a6%82%e4%bd%95%e5%88%a4%e6%96%ad%e4%b8%80%e4%b8%aa-shell-%e6%98%af%e5%90%a6%e6%98%af%e4%ba%a4%e4%ba%92%e5%bc%8f%e7%9a%84%e5%91%a2>如何判断一个 shell 是否是交互式的呢</a></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#shell--%e8%af%ad%e6%b3%95>Shell 语法</a></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e7%bc%96%e5%86%99%e5%b9%b6%e8%b0%83%e8%af%95%e8%84%9a%e6%9c%ac>编写并调试脚本</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e8%b0%83%e8%af%95%e8%84%9a%e6%9c%ac>调试脚本</a></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%8f%98%e9%87%8f-variables->变量（ Variables ）</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%88%9b%e5%bb%ba%e5%8f%98%e9%87%8f>创建变量</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%af%bc%e5%87%ba%e5%8f%98%e9%87%8f>导出变量</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#shell--%e7%9a%84%e4%bf%9d%e7%95%99%e5%8f%98%e9%87%8freserved-variables>Shell 的保留变量（Reserved variables）</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e7%89%b9%e6%ae%8a%e5%8f%82%e6%95%b0-special-parameters>特殊参数（ Special parameters）</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#quoting-characters>Quoting Characters</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%8f%98%e9%87%8f%e7%9a%84%e7%b1%bb%e5%9e%8b>变量的类型</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%b8%b8%e9%87%8f>常量</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e6%95%b0%e7%bb%84>数组</a></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e6%93%8d%e4%bd%9c%e5%8f%98%e9%87%8f>操作变量</a></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#shell--%e5%b1%95%e5%bc%80shell-expansion>Shell 展开（shell expansion）</a><ul><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%a4%a7%e6%8b%ac%e5%8f%b7%e5%b1%95%e5%bc%80-brace-expansion->大括号展开（ Brace expansion ）</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e6%b3%a2%e6%b5%aa%e5%8f%b7%e5%b1%95%e5%bc%80-tilde-expansion->波浪号展开（ tilde expansion ）</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#shell--%e5%8f%82%e6%95%b0%e5%92%8c%e5%8f%98%e9%87%8f%e5%b1%95%e5%bc%80>Shell 参数和变量展开</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%91%bd%e4%bb%a4%e6%9b%bf%e6%8d%a2>命令替换</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e7%ae%97%e6%9c%af%e5%b1%95%e5%bc%80>算术展开</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e8%bf%9b%e7%a8%8b%e6%9b%bf%e6%8d%a2>进程替换</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%88%86%e8%af%8d-word-splitting->分词（ word splitting ）</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e6%96%87%e4%bb%b6%e5%90%8d%e6%9b%bf%e6%8d%a2>文件名替换</a></li></ul></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8fregular-expressions>正则表达式（Regular expressions）</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#regular-expression-metacharacters>Regular expression metacharacters</a></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#sed>Sed</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#awk>Awk</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#print><code>print</code></a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e4%bd%bf%e7%94%a8%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f>使用正则表达式</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e7%89%b9%e6%ae%8a%e6%a8%a1%e5%bc%8f>特殊模式</a></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#awk--%e4%b8%ad%e7%9a%84%e5%8f%98%e9%87%8f><code>awk</code> 中的变量</a></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e6%9d%a1%e4%bb%b6%e8%a1%a8%e8%be%be%e5%bc%8f>条件表达式</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#if><code>if</code></a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#primary-expressions>Primary Expressions</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#combining-expressions>Combining Expressions</a></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#ifthenelse><code>if/then/else</code></a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#ifthenelifelse><code>if/then/elif/else</code></a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#case><code>case</code></a></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%be%aa%e7%8e%af>循环</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#for><code>for</code></a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#while><code>while</code></a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#until><code>until</code></a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#select><code>select</code></a></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%87%bd%e6%95%b0>函数</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e9%87%8d%e5%ae%9a%e5%90%91%e4%b8%8e%e6%96%87%e4%bb%b6%e6%8f%8f%e8%bf%b0%e7%ac%a6>重定向与文件描述符</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e6%8d%95%e6%8d%89%e4%bf%a1%e5%8f%b7>捕捉信号</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#worth-to-read>Worth to Read</a></li></ul></div></div></nav></div><div class="max-w-2xl px-6 pt-6 pb-16 mx-auto prose dark:prose-invert dark:text-white"><h1 id=bash-与-bash-脚本>Bash 与 Bash 脚本</h1><ul><li><h2 id=shell>Shell</h2><ul><li><p>Shell 脚本是解释执行的。</p><ul><li><blockquote class=hint>Shell scripts are <strong>interpreted</strong>, not compiled. The shell reads commands from the script line per line and searches for those commands on the system, while a compiler converts a program into machine readable form, an executable file - which may then be used in a shell script.</blockquote></li></ul></li><li><p>Shell 有很多种，常见的有 sh（Bourne Shell）、bash（Bourne Again shell）、csh（C shell）、tcsh（TENEX C shell）、ksh（Korn shell）、tmux等</p></li><li><p>查看系统内已经有的 shell：<code>cat/etc/shells</code></p></li><li><p>查看当前用户默认的 shell：<code>cat/etc/passwd | grep $USER</code> （输出的最后就是当前用户默认的 shell，一般都是 bash）</p></li></ul></li><li><h2 id=bash>Bash</h2><ul><li><p>Bash 是 Shell 的一种，具备很多 Shell 不具备的特性。</p></li><li><h3 id=bash--启动时加载的文件>Bash 启动时加载的文件</h3><ul><li><p>当 bash 在不同的情况下被调用时（invoked），它会在启动时会读取并执行一些特定的文件，文件的读取顺序会在下列出，如果某个文件不存在，bash 就会继续查找下一个文件。</p></li><li><h4 id=invoked-as-an-interactive-login-shell--or-with---login><em>Invoked as an interactive login shell</em> <em>，</em> <em>or with <code>--login</code></em></h4><ul><li><p>交互式（interactive）bash 意味着我们可以输入命令，shell 通常会从它连接到的终端（terminal）读取命令，然 将执行结果输出到终端。而 login shell 则表示系统会在使用者使用 shell 之前对其进行身份的认证（通常要使用提供用户名和密码）。这种情况下 bash 启动时读取的文件有：</p><ul><li><p><code>/etc/profile</code></p></li><li><p><code>~/.bash_profile</code>, <code>~/.bash_login</code> 或 <code>~/.profile</code>：第一个存在的可读文件会被读取</p></li><li><p><code>~/.bash_logout</code>：退出时读取</p></li></ul></li></ul></li><li><h4 id=invoked-as-an-interactive-non-login-shell><em>Invoked as an interactive non-login shell</em></h4><ul><li><p>non-login shell 表示系统在使用者使用 shell 之前不会对其进行身份的认证。这种情况下读取的文件有：</p><ul><li><code>~/.bashrc</code></li></ul></li></ul></li><li><h4 id=invoked-non-interactively><em>Invoked non-interactively</em></h4><ul><li><p>所有 bash 脚本使用的都是非交互式（non-interactively）shell。这时读取的文件有：</p><ul><li>由变量 <code>BASH_ENV</code> 定义的文件，不过在搜索这个文件时并不会用上 <code>PATH</code></li></ul></li></ul></li><li><h4 id=invoked-with-the-sh-command><em>Invoked with the sh command</em></h4><ul><li><p>这个时候读取的文件有：</p><ul><li><p><code>/etc/profile</code></p></li><li><p><code>~/.profile</code></p></li></ul></li></ul></li></ul></li><li><h3 id=如何判断一个-shell-是否是交互式的呢>如何判断一个 shell 是否是交互式的呢</h3><ul><li>通过查看特殊参数 <code>-</code> 的内容，我们可以判断当前 shell 是否是交互式的。如果它的内容含有字母 <code>i</code>，则说明当前 shell 是交互式 shell，否则是非交互式 shell。</li></ul></li></ul></li></ul><p><code>bash ~$ echo $- himBHs ~$ echo 'echo $-' > ./non-interactive-shell.sh ~$ chmod +x ./non-interactive-shell.sh ~$ ./non-interactive-shell.sh hB</code></p><ul><li><h2 id=shell--语法>Shell 语法</h2><ul><li><p>如果输入不是注释（comment），shell 会读入并将其拆分成单词（word）和操作符（operator），使用 quoting rules 定义输入中每个字符的含义。然后，这些单词和操作符会被翻译成命令和其它结构（constructs）。Shell分析输入的过程如下：</p><ul><li><p>Shell 从文件、字符串或用户的终端读取输入</p></li><li><p>按照 quoting rules 将输入分解为单词和操作符。这些符号（token）被元字符（metacharacter）分隔。别名（alias）展开被执行</p></li><li><p>Shell 将这些符号解析（分析和替换）成为简单命令或复合命令</p></li><li><p>Bash 执行各种 shell 展开（expansion），将展开的符号分解成文件名（filename）、命令（command）和参数（argument）列表</p></li><li><p>如果有必要的话，重定向被执行。重定向操作符和它们的操作数被从参数列表中移除</p></li><li><p>命令被执行</p></li><li><p>（可选）shell 等待命令执行完毕并收集命令的退出状态。</p></li></ul></li></ul></li></ul><h1 id=编写并调试脚本>编写并调试脚本</h1><ul><li><p>Shell 脚本的第一行应该以 <code>#!</code> 开始，后面是执行此脚本的 shell 的路径。例如：<code>#!/bin/bash</code> 。空白行也算作有效行。</p></li><li><h2 id=调试脚本>调试脚本</h2><ul><li><p>若要调试（debug）整个脚本，可以使用 bash 的 <code>-x</code>（在执行命令之前打印命令的 trace 信息）选项，例如：<code>bash -x your_script.sh</code>。</p></li><li><p>而 bash内置的 <code>set</code> 可以允许我们只展示关注部分的调试信息，<code>set</code> 可以在脚本中使用任意多次。被调试的部分位于 <code>set -x</code> （开启调试）和 <code>set +x</code>（关闭调试），注意 <code>+/-</code>的区别。</p></li></ul></li></ul><h1 id=变量-variables->变量（ Variables ）</h1><ul><li><p>Shell 变量通常是大写的。按照作用域的不同，变量分为全局变量（global variables）和局部变量（local variables）。</p><ul><li><p>全局变量也就是我们通常说的环境变量（environment variables），对所有的 shell 都有效。查看环境变量的命令：<code>env</code> 或 <code>printenv</code>。</p></li><li><p>局部变量只对当前的 shell 有效。使用 shell 内置的 set 命令（不带任何选项参数）就可以输出所有变量（包括环境变量）和一系列的函数。</p></li></ul></li><li><p>除了作用域，变量也可以按内容的类型进行分类，有四种：</p><ul><li><p>字符串变量（String variables）</p></li><li><p>整型变量（Integer variables）</p></li><li><p>常量变量（Constant variables）</p></li><li><p>数组变量（Array variables）</p></li></ul></li><li><h2 id=创建变量>创建变量</h2><ul><li>变量名是大小写敏感的，默认大写。有时候，我们也会用小写命名局部变量，而用大写命名全局变量。变量名可以包含数字，但是不能以数字开头。定义变量的语法为：<code>VARNAME="value"</code>。与我们常用的编程语言不同，<strong>shell 中变量定义中的等号两侧是不能有空格的</strong>，否则会出现错误。</li></ul></li><li><h2 id=导出变量>导出变量</h2><ul><li>在shell 中创建的变量只对当前 shell 有效，它们都是局部变量。如果我们在当前 shell 中使用 <code>bash</code> 或类似的命令开启一个子 shell，父 shell 中定义的变量是不可用的。要将变量传递到子 shell 中，我们可以使用 <code>export</code> 命令导出变量，导出后的变量就会被当作环境变量对待。</li></ul></li><li><h2 id=shell--的保留变量reserved-variables>Shell 的保留变量（Reserved variables）</h2><ul><li><p>太多了，具体查看：<a href=https://tldp.org/LDP/Bash-Beginners-Guide/html/sect_03_02 target=_blank>https://tldp.org/LDP/Bash-Beginners-Guide/html/sect_03_02</a>
.</p></li><li><p>比如：<code>PATH</code>、<code>HOME</code>、<code>PS1</code>、<code>PS2</code>、<code>PWD</code>、<code>UID</code> 等。<code>PS</code> 即 <code>prompt string</code>。</p></li></ul></li><li><h2 id=特殊参数-special-parameters>特殊参数（ Special parameters）</h2><ul><li><p>有一些参数我们只能引用，而不能对它们进行赋值，因为这些参数会被 Shell 特殊处理。</p><ul><li><table><thead><tr><th>Character</th><th>Definition</th></tr></thead><tbody><tr><td>$*</td><td>Expands to the positional parameters, starting from one. When the expansion occurs within double quotes, it expands to a single word with the value of each parameter separated by the first character of the IFS special variable.</td></tr><tr><td>$@</td><td>Expands to the positional parameters, starting from one. When the expansion occurs within double quotes, each parameter expands to a separate word.</td></tr><tr><td>$#</td><td>Expands to the number of positional parameters in decimal.</td></tr><tr><td>$?</td><td>Expands to the exit status of the most recently executed foreground pipeline.</td></tr><tr><td>$-</td><td>A hyphen expands to the current option flags as specified upon invocation, by the <strong>set</strong> built-in command, or those set by the shell itself (such as the -i).</td></tr><tr><td>$$</td><td>Expands to the process ID of the shell.</td></tr><tr><td>$!</td><td>Expands to the process ID of the most recently executed background (asynchronous) command.</td></tr><tr><td>$0</td><td>Expands to the name of the shell or shell script.</td></tr><tr><td>$_</td><td>The underscore variable is set at shell startup and contains the absolute file name of the shell or script being executed as passed in the argument list. Subsequently, it expands to the last argument to the previous command, after expansion. It is also set to the full pathname of each command executed and placed in the environment exported to that command. When checking mail, this parameter holds the name of the mail file.</td></tr></tbody></table></li></ul></li><li></li></ul></li><li><h2 id=quoting-characters>Quoting Characters</h2><ul><li><p>在很多上下文中，很多字符或者单词都有特殊的含义，用引号将它们引起来可以消除这些特殊含义。</p><ul><li><p>转义字符（<code>\</code> ）</p><ul><li>转义字符（Escape characters）用来移除<strong>其后单个字符</strong>的特殊含义。</li></ul></li><li><p>单引号（ <code>''</code> ）</p><ul><li>单引号（Single quotes）被用来移除两个单引号之间所有字符的特殊含义，即单引号中的所有字符都是字面值（literal value）。两个单引号之间是不能有单引号的，即便这个单引号被转义都不行。</li></ul></li><li><p>双引号（<code>""</code> ）</p><ul><li><p>双引号（Doublequotes）会移除两个双引号之间除美元符号（<code>$</code>）、反引号（`）和反斜杠（<code>\</code>）之外的所有字符的特殊含义。美元符号和反引号的特殊含义在双引号之间会保留，而反斜杠只有在其后的字符是美元符号、反引号、双引号、反斜杠或换行符时才保留特殊含义，输入流会将这些字符前的反斜杠去掉。</p></li><li><p>双引号之间是可以有由反斜杠转义的双引号的。</p></li></ul></li></ul></li></ul></li><li><h2 id=变量的类型>变量的类型</h2><ul><li><p>很多情况下，我们在定义 shell 变量时并不会显式给出变量类型。如果有必要，我们可以使用 <code>declare</code> 语句限制赋值给变量的值的类型。<code>declare</code> 语句的语法为：<code>declare OPTION(s) VARIABLE=value</code>。支持的 <code>OPTION(s)</code> 有：</p><ul><li><table><thead><tr><th>Option</th><th>Meaning</th><th></th></tr></thead><tbody><tr><td>-a</td><td>Variable is an array.</td><td></td></tr><tr><td>-f</td><td>Use function names only.</td><td></td></tr><tr><td>-i</td><td>The variable is to be treated as an integer; arithmetic evaluation is performed when the variable is assigned a value.</td><td></td></tr><tr><td>-p</td><td>Display the attributes and values of each variable. When -p is used, additional options are ignored.</td><td></td></tr><tr><td>-r</td><td>Make variables read-only. These variables cannot then be assigned values by subsequent assignment statements, nor can they be unset.</td><td></td></tr><tr><td>-t</td><td>Give each variable the <em>trace</em> attribute.</td><td></td></tr><tr><td>-x</td><td>Mark each variable for export to subsequent commands via the environment.</td><td></td></tr></tbody></table></li></ul></li><li><h3 id=常量>常量</h3><ul><li>只读的变量就是常量（constant），使用 <code>readonly</code> 就可以创建出不可被改变的变量，即常量。语法为 <code>readonly OPTION VARIABLE(s)</code></li></ul></li><li><h3 id=数组>数组</h3><ul><li><p>Shell 中的数组就是一个包含多个值的变量，数组的大小没有限制，下标从 <code>0</code> 开始。数组的声明方法有两种：</p><ul><li><p>间接声明：<code>ARRAY[INDEXNR]=value</code>。</p></li><li><p>显式声明：<code>declare -a ARRAYNAME</code>。</p></li></ul></li><li><p>数组变量也可以使用复合赋值的方式创建：<code>ARRAY=(value1 value2 … valueN)</code>。</p></li><li><p>给数组添加缺失的或额外的成员的语法为：<code>ARRAYNAME[indexnumber]=value</code>。</p></li><li><p>删除数组本身或数组成员的命令是：<code>unset</code>。</p></li><li></li></ul></li></ul></li><li><h2 id=操作变量>操作变量</h2><ul><li><p><code>${#VAR}</code>：计算变量包含多少个字符或计算数组中元素的数量</p></li><li><p><code>${VAR:-WORD}</code>：变量替换。若变量 <code>VAR</code> 未定义或为 <code>null</code>，则替换为 <code>WORD</code> 的展开，否则保持 <code>VAR</code> 的值</p></li><li><p><code>${VAR:OFFSET:LENGTH}</code>：跳过 <code>VAR</code> 开头的 <code>OFFSET</code> 个字符，然后截取出 <code>LENGTH</code> 个字符</p></li><li><p><code>${VAR#WORD}</code> 或 <code>${VAR##WORD}</code>：删除 <code>VAR</code> 中匹配上 <code>WORD</code> 展开的模式。<code>#</code> 和 <code>##</code> 分别表示最短匹配和最长匹配</p></li><li><p><code>${VAR/PATTERN/STRING}</code> 或 <code>${VAR//PATTERN/STRING}</code>：替换变量中的某些部分</p></li></ul></li></ul><h1 id=shell--展开shell-expansion>Shell 展开（shell expansion）</h1><ul><li><h3 id=大括号展开-brace-expansion->大括号展开（ Brace expansion ）</h3><ul><li>大括号展开的形式为：一个可选的前导符（PREAMBLE）、一组位于一对大括号之间的由逗号分隔的字符串和一个可选的跋（POSTSCRIPT）。例如：</li></ul></li></ul><p><code>bash ~$ echo sp{el,il,al}l spell spill spall</code></p><ul><li><h3 id=波浪号展开-tilde-expansion->波浪号展开（ tilde expansion ）</h3><ul><li><p>如果一个单词以没有被引起来的波浪号（<code>~</code>）开始，则在第一个没有被引起来的斜杠（若没有斜杠，则一直到最后一个字符）之前的字符将被视作波浪号前缀（tidle-prefix）。如果波浪号前缀中没有字符被引起来，那么波浪号前缀中的这些字符就会被当作一个可能的登录用户名。如果这个登录用户名是 <code>null</code> 字符串，则波浪号被替换为 shell 变量 HOME。如果 HOME 变量没有被设置，则替换为执行这个 shell 的用户的主目录。</p></li><li><p>如果波浪号前缀是<code>~+</code>，那么它会被替换为变量 <code>PWD</code> 的值。如果波浪号前缀是<code>~-</code>，那么它会被替换为变量 <code>OLDPWD</code> 的值。</p></li></ul></li><li><h3 id=shell--参数和变量展开>Shell 参数和变量展开</h3><ul><li><p>美元符号（<code>$</code>）用于参数展开、命令替换或算术展开。被展开的参数名或符号可能被包裹在大括号中。</p></li><li><p>最基本的参数展开的形式是<code>${PARAMETER}</code>。如果我们想在某个变量不存在时创建这个变量，则可以使用<code>${VAR:=value}</code></p></li></ul></li><li><h3 id=命令替换>命令替换</h3><ul><li><p>命令替换（command substitution）允许我们用命令的输出来替换命令本身，它有两种形式：</p><ul><li><p><code>$(command)</code></p></li><li><p>`command`</p></li></ul></li></ul></li><li><h3 id=算术展开>算术展开</h3><ul><li><p>算术展开（arithmetic expansion）允许我们用一个算术表达式计算得到的值替换表达式本身。它也有两种形式：</p><ul><li><p><code>$(( EXPRESSION ))</code></p></li><li><p><code>$[ EXPRESSION ]</code></p></li></ul></li></ul></li><li><h3 id=进程替换>进程替换</h3><ul><li><p>进程替换（Process substitution）在支持命名管道（FIFO）和命名打开文件的 <code>/dev/fd</code> 方法的系统上。形式也有两种：</p><ul><li><p><code>&lt;(LIST)</code></p></li><li><p><code>>(LIST)</code></p></li></ul></li></ul></li><li><h3 id=分词-word-splitting->分词（ word splitting ）</h3><ul><li>Shell 会扫描不在双引号之内的参数展开、命令替换和算术展开的结果，用于分词。分隔符为变量 <code>IFS</code> 中的每个字符，默认为<code>&lt;space>&lt;tab>&lt;newline></code></li></ul></li><li><h3 id=文件名替换>文件名替换</h3><ul><li>分词之后，如果 <code>bash</code> 的 <code>-f</code> 选项没有被设置，<code>bash</code> 就会扫描每个单词，寻找字符 <code>*</code>、<code>?</code>、<code>[</code>。如果这三个字符一个都没找到，单词会被视为一个模式（PATTERN），然后被替换为一个按照字段序排列与这个模式相匹配的文件名列表。</li></ul></li><li></li></ul><h1 id=正则表达式regular-expressions>正则表达式（Regular expressions）</h1><ul><li><p>A <em>regular expression</em> is a pattern that describes a set of strings.</p></li><li><p>The fundamental building blocks are the regular expressions that match a single character. Most characters, including all letters and digits, are regular expressions that match themselves. Any metacharacter with special meaning may be quoted by preceding it with a backslash.</p></li><li><h2 id=regular-expression-metacharacters>Regular expression metacharacters</h2><ul><li><p>A regular expression may be followed by one of several repetition operators (metacharacters):</p><ul><li><p><strong>Regular expression operators</strong></p><ul><li><table><thead><tr><th>Operator</th><th>Effect</th><th></th></tr></thead><tbody><tr><td>.</td><td>Matches any single character.</td><td></td></tr><tr><td>?</td><td>The preceding item is optional and will be matched, at most, once.</td><td></td></tr><tr><td>*</td><td>The preceding item will be matched zero or more times.</td><td></td></tr><tr><td>+</td><td>The preceding item will be matched one or more times.</td><td></td></tr><tr><td>{N}</td><td>The preceding item is matched exactly N times.</td><td></td></tr><tr><td>{N,}</td><td>The preceding item is matched N or more times.</td><td></td></tr><tr><td>{N,M}</td><td>The preceding item is matched at least N times, but not more than M times.</td><td></td></tr><tr><td>-</td><td>represents the range if it&rsquo;s not first or last in a list or the ending point of a range in a list.</td><td></td></tr><tr><td>^</td><td>Matches the empty string at the beginning of a line; also represents the characters not in the range of a list.</td><td></td></tr><tr><td>$</td><td>Matches the empty string at the end of a line.</td><td></td></tr><tr><td>\b</td><td>Matches the empty string at the edge of a word.</td><td></td></tr><tr><td>\B</td><td>Matches the empty string provided it&rsquo;s not at the edge of a word.</td><td></td></tr><tr><td>&lt;</td><td>Match the empty string at the beginning of word.</td><td></td></tr><tr><td>></td><td>Match the empty string at the end of word.</td><td></td></tr></tbody></table></li></ul></li></ul></li></ul></li></ul><h1 id=sed>Sed</h1><ul><li><p><code>sed</code>（Stream EDitor）可以对从文件或管道读取的文本进行基本的变换操作，然后将结果输出到标准输出。<code>sed</code> 本身并不会修改原始的输入。</p></li><li><p><code>sed</code> 可以使用正则表达式进行文本的模式替换和删除。</p></li></ul><h1 id=awk>Awk</h1><ul><li><p><code>awk</code> 是一个很流行的 UNIX 流编辑器，而 <code>gawk</code> 则是 <code>awk</code> 的 GNU 版本。很多情况下，<code>awk</code> 被链接到 <code>gawk</code>，所以一般都叫 <code>awk</code>。<code>awk</code> 的名字来源于创建这门编程语言的三个人姓名（Aho、Kernighan 和 Weinberger）的首字母。</p></li><li><p><code>awk</code> 的基本功能是在文件中搜索包含一个或多个模式（pattern）的行或文本单元，当某一行满足某个模式时，会在该行上执行特殊的操作。</p></li><li><p><code>awk</code> 最大的不同在于它是数据驱动（data-driven）的，即”you describe the data you want to work with and then what to do when you find it“。</p></li><li><p>在运行 <code>awk</code> 时，我们需要声明一个<code>awk</code> 程序，这个程序告诉 <code>awk</code> 应该做什么，它包含一系列的规则（rule），每个规则都声明了一个用于搜索的模式和找到模式后要执行的一个操作（action）。如果程序很短，直接在命令行给出即可（<code>awk PROGRAM inputfile(s)</code>），也可以将 <code>awk</code> 程序放到一个单独的脚本中，然后使用<code>-f</code> 参数读取（<code>awk -f PROGRAM-FILE inputfile(s)</code>）。</p></li><li><h2 id=print><code>print</code></h2><ul><li><p><code>awk</code> 的 <code>print</code> 命令可以用来输出从输入文件选取的数据。<code>awk</code> 每读取文件中的一行，就会使用 <code>FS</code>（输入字段分隔符，input field seperator）对该行进行拆分。<code>FS</code> 是 <code>awk</code> 的一个内置变量，通常默认为一个或多个空格（space）或制表符（tab）。拆分后会得到一系列的变量：<code>$1</code>、<code>$2</code>、…、<code>$N</code>，它们分别持有输出行的第<code>1</code>、<code>2</code>、…、最后一个字段。而变量<code>$0</code> 持有的是整行的值。</p></li><li><p>示例命令： <code>ls -l | awk '{print $5 $9 }'</code></p></li></ul></li><li><h2 id=使用正则表达式>使用正则表达式</h2><ul><li><p>正则表达式可以被用作模式对文本中的每一行（一行就是一条记录（record））进行测试，使用时只需要将正则表达式用斜杠（<code>/</code>）引起来即可，例如：<code>df -h | awk '/dev/hd/ {print $6 "\t: " $5}'</code></p></li><li><p>完整的语法为：<code>awk 'EXPRESSION { PROGRAM }' files(s)</code></p></li><li><h3 id=特殊模式>特殊模式</h3><ul><li>若要在 <code>awk</code> 处理文本前或处理完文本后执行某些操作，可以分别使用 <code>BEGIN</code> 和 <code>END</code> 语句。</li></ul></li></ul></li><li><h2 id=awk--中的变量><code>awk</code> 中的变量</h2><ul><li><p>字段分隔符（field seperator）告知 <code>awk</code> 如何将记录（record）分割成字段（field），它可以是单个字符，也可以是一个正则表达式。字段分隔符用内置变量 <code>FS</code> 表示，我们可以在 <code>BEGIN</code> 模式中使用赋值操作符（<code>=</code>）对它进行修改，例如<code>awk 'BEGIN {FS=":" } {print $1 "\t" $5 }' /etc/passwd</code> 使用冒号（<code>:</code>）作为分隔符。</p></li><li><p>在 <code>print</code> 输出时，如果语法正确（即参数之间使用逗号分隔），字段默认使用空格分隔，语法错误会导致输出字段之间的分隔符被省略，字段会一个挨一个的输出。输出字段分隔符（output field seperator）使用变量 <code>OFS</code> 表示，我们同样可以在 <code>BEGIN</code> 模式中修改它的默认值。</p></li><li><p>默认情况下，<code>print</code> 语句的输出被称为输出记录（output record）。每条 <code>print</code> 命令都会产生一条输出记录，然后跟着一个被称为输出记录分隔符（output record separator）的字符串。输出记录分隔符用变量 <code>ORS</code> 表示，它的值默认为 <code>\n</code>，可以在 <code>BEGIN</code> 语句中修改。</p></li><li><p><code>awk</code> 内置的 <code>NR</code> 变量记录着已处理的记录的行数，<code>awk</code> 每读取一个新的输入行，<code>NR</code> 的值就会加一。</p></li></ul></li></ul><h1 id=条件表达式>条件表达式</h1><ul><li><h2 id=if><code>if</code></h2><ul><li><p>在 shell 中，<code>if</code> 表达式的精简语法为：<code>if TEST-COMMANDS; then CONSEQUENT-CONMMANDS; fi</code></p></li><li><p><code>TEST-COMMANDS</code> 列表执行后，如果它的返回状态是 <code>0</code>，那么 <code>CONSEQUENT-COMMANDS</code> 列表就会被执行，其中最后一条命令的退出状态就是整个 <code>if</code> 表达式的返回状态。如果没有条件为 <code>true</code>，则返回 <code>0</code>。</p></li><li><h3 id=primary-expressions>Primary Expressions</h3><ul><li><p>我们一般将构成 <code>TEST-COMMANDS</code> 的表达式称为 <code>primaries</code>。</p><ul><li><p><strong>Primary expressions</strong></p><ul><li><table><thead><tr><th>Primary</th><th>Meaning</th><th></th></tr></thead><tbody><tr><td>[ -a FILE ]</td><td>True if FILE exists.</td><td></td></tr><tr><td>[ -b FILE ]</td><td>True if FILE exists and is a block-special file.</td><td></td></tr><tr><td>[ -c FILE ]</td><td>True if FILE exists and is a character-special file.</td><td></td></tr><tr><td>[ -d FILE ]</td><td>True if FILE exists and is a directory.</td><td></td></tr><tr><td>[ -e FILE ]</td><td>True if FILE exists.</td><td></td></tr><tr><td>[ -f FILE ]</td><td>True if FILE exists and is a regular file.</td><td></td></tr><tr><td>[ -g FILE ]</td><td>True if FILE exists and its SGID bit is set.</td><td></td></tr><tr><td>[ -h FILE ]</td><td>True if FILE exists and is a symbolic link.</td><td></td></tr><tr><td>[ -k FILE ]</td><td>True if FILE exists and its sticky bit is set.</td><td></td></tr><tr><td>[ -p FILE ]</td><td>True if FILE exists and is a named pipe (FIFO).</td><td></td></tr><tr><td>[ -r FILE ]</td><td>True if FILE exists and is readable.</td><td></td></tr><tr><td>[ -s FILE ]</td><td>True if FILE exists and has a size greater than zero.</td><td></td></tr><tr><td>[ -t FD ]</td><td>True if file descriptor FD is open and refers to a terminal.</td><td></td></tr><tr><td>[ -u FILE ]</td><td>True if FILE exists and its SUID (set user ID) bit is set.</td><td></td></tr><tr><td>[ -w FILE ]</td><td>True if FILE exists and is writable.</td><td></td></tr><tr><td>[ -x FILE ]</td><td>True if FILE exists and is executable.</td><td></td></tr><tr><td>[ -O FILE ]</td><td>True if FILE exists and is owned by the effective user ID.</td><td></td></tr><tr><td>[ -G FILE ]</td><td>True if FILE exists and is owned by the effective group ID.</td><td></td></tr><tr><td>[ -L FILE ]</td><td>True if FILE exists and is a symbolic link.</td><td></td></tr><tr><td>[ -N FILE ]</td><td>True if FILE exists and has been modified since it was last read.</td><td></td></tr><tr><td>[ -S FILE ]</td><td>True if FILE exists and is a socket.</td><td></td></tr><tr><td>[ FILE1 -nt FILE2 ]</td><td>True if FILE1 has been changed more recently than FILE2, or if FILE1 exists and FILE2 does not.</td><td></td></tr><tr><td>[ FILE1 -ot FILE2 ]</td><td>True if FILE1 is older than FILE2, or is FILE2 exists and FILE1 does not.</td><td></td></tr><tr><td>[ FILE1 -ef FILE2 ]</td><td>True if FILE1 and FILE2 refer to the same device and inode numbers.</td><td></td></tr><tr><td>[ -o OPTIONNAME ]</td><td>True if shell option &ldquo;OPTIONNAME&rdquo; is enabled.</td><td></td></tr><tr><td>[ -z STRING ]</td><td>True of the length if &ldquo;STRING&rdquo; is zero.</td><td></td></tr><tr><td>[ -n STRING ] or [ STRING ]</td><td>True if the length of &ldquo;STRING&rdquo; is non-zero.</td><td></td></tr><tr><td>[ STRING1 <mark>STRING2 ] | True if the strings are equal. &ldquo;=&rdquo; may be used instead of "
</mark>" for strict POSIX compliance.</td><td></td><td></td></tr><tr><td>[ STRING1 != STRING2 ]</td><td>True if the strings are not equal.</td><td></td></tr><tr><td>[ STRING1 &lt; STRING2 ]</td><td>True if &ldquo;STRING1&rdquo; sorts before &ldquo;STRING2&rdquo; lexicographically in the current locale.</td><td></td></tr><tr><td>[ STRING1 > STRING2 ]</td><td>True if &ldquo;STRING1&rdquo; sorts after &ldquo;STRING2&rdquo; lexicographically in the current locale.</td><td></td></tr><tr><td>[ ARG1 OP ARG2 ]</td><td>&ldquo;OP&rdquo; is one of -eq, -ne, -lt, -le, -gt or -ge. These arithmetic binary operators return true if &ldquo;ARG1&rdquo; is equal to, not equal to, less than, less than or equal to, greater than, or greater than or equal to &ldquo;ARG2&rdquo;, respectively. &ldquo;ARG1&rdquo; and &ldquo;ARG2&rdquo; are integers.</td><td></td></tr></tbody></table></li></ul></li></ul></li></ul></li><li><h3 id=combining-expressions>Combining Expressions</h3><ul><li><p>表达式之间也可以进行组合</p></li><li><p><strong>Combining expressions</strong></p><ul><li><table><thead><tr><th>Operation</th><th>Effect</th><th></th></tr></thead><tbody><tr><td>[ ! EXPR ]</td><td>True if <strong>EXPR</strong> is false.</td><td></td></tr><tr><td>[ ( EXPR ) ]</td><td>Returns the value of <strong>EXPR</strong>. This may be used to override the normal precedence of operators.</td><td></td></tr><tr><td>[ EXPR1 -a EXPR2 ]</td><td>True if both <strong>EXPR1</strong> and <strong>EXPR2</strong> are true.</td><td></td></tr><tr><td>[ EXPR1 -o EXPR2 ]</td><td>True if either <strong>EXPR1</strong> or <strong>EXPR2</strong> is true.</td><td></td></tr></tbody></table></li></ul></li></ul></li><li><p>The <code>[</code> (or <code>test</code>) built-in evaluates conditional expressions using a set of rules based on the number of arguments.</p></li><li><div class=tip><code>[]</code> 与 <code>[[]]</code> 的区别在于：<code>[[</code> 会阻止 shell 进行变量名的分词操作、阻止路径名展开。</div></li></ul></li><li><h2 id=ifthenelse><code>if/then/else</code></h2><ul><li><code>if/then/else</code> 的语法为：<code>if TEST-COMMANDS; then CONSEQUENT-CONMMANDS; else ALTERNATE-CONSEQUENT-COMMANDS; fi</code>。</li></ul></li><li><h2 id=ifthenelifelse><code>if/then/elif/else</code></h2><ul><li><code>if</code> 表达式的完整的语法为：<code>if TEST-COMMANDS; then CONSEQUENT-CONMMANDS; elif MORE-TEST-COMMANDS; then MORE-CONSEQUENT-COMMANDS; else ALTERNATE-CONSEQUENT-COMMANDS; fi</code>。</li></ul></li><li><h2 id=case><code>case</code></h2><ul><li><code>case</code> 表达式的语法为：<code>case EXPRESSION in CASE1) COMMAND-LIST;; CASE2) COMMAND-LIST;;… CASEN) COMMAND-LIST;; easc</code>。</li></ul></li></ul><h1 id=循环>循环</h1><ul><li><h2 id=for><code>for</code></h2><ul><li><p>For 循环的语法为：<code>for NAME [in LIST ]; do COMMANDS; done</code>。</p></li><li><p>如果<code>[in LIST]</code>不存在，则它会被替换为 <code>in $@</code>，<code>for</code> 循环会为每一个位置参数执行一遍 <code>COMMANDS</code>。</p></li></ul></li><li><h2 id=while><code>while</code></h2><ul><li><code>while</code> 循环的语法为：<code>while CONTROL-COMMAND; do CONSEQUENT-COMMANDS; done</code>。</li></ul></li><li><h2 id=until><code>until</code></h2><ul><li><code>until</code> 循环的语法为：<code>until TEST-COMMAND; do CONSEQUENT-COMMANDS; done</code>。</li></ul></li><li><h2 id=select><code>select</code></h2><ul><li><code>select</code> 一般用于生成菜单，语法为：<code>select WORD [in LIST]; do RESPECTIVE-COMMANDS; done</code>。</li></ul></li><li></li></ul><h1 id=函数>函数</h1><ul><li><p>在 shell 中，定义函数的语法为：<code>function FUNCTION {CONMMANDS; }</code> 或 <code>FUNCTION() { COMMANDS;}</code>。</p></li><li><p>大括号内最后一条命令的退出状态就是整个函数的退出状态。大括号与函数体之间必须有空白符，否则会出错。函数体应该以分号或者一个新行结尾。</p></li></ul><h1 id=重定向与文件描述符>重定向与文件描述符</h1><ul><li><p>文件输入和输出是通过整数句柄（integer handle）实现的，这些整数句柄跟踪着指定进程打开的所有文件。这些数字就是文件描述符（file descriptor）。</p></li><li><p>最常见的文件描述符是标准输入（stdin）、标准输出（stdout）和标准错误（stderr），它们的文件描述符数字分别是<code>0</code>、<code>1</code>、<code>2</code>。这些数字和相应的设备都是系统保留的，我们可以通过命令 <code>ls -l /dev/std</code> 查看。</p></li><li><p>每个进程看到的 <code>/proc/self</code> 目录下的东西都不一样，因为 <code>/proc/self</code> 实际上是一个指向 <code>/proc/&lt;process_ID></code> 的符号链接。</p></li><li><p>当执行一条命令时，会遵循以下步骤：</p><ul><li><p>如果上一条命令的标准输出被管道到当前命令的标准输入，那么 <code>/proc/&lt;current_process_ID>/fd/0</code> 会被更新为与
<code>/proc/&lt;previous_process_ID>/fd/1</code> 相同的匿名管道</p></li><li><p>如果当前命令的标准输出被管道到下一条命令的标准输入，那么 <code>/proc/&lt;current_process_ID>/fd/1</code> 会被更新为另一个匿名管道</p></li><li><p>当前命令中的重定向从左到右依次被处理</p></li><li><p>一个命令后的重定向 <code>N>&amp;M</code> 或 <code>N&lt;&amp;M</code> 的效果与创建或更新符合链接 <code>/proc/self/fd/N</code> 与 <code>/proc/self/fd/M</code> 到同一个目标的效果一样</p></li><li><p>重定向 <code>N>file</code> 和 <code>N&lt;file</code> 与创建或更新符号链接到 <code>/proc/self/fd/N</code> 到同一个目标文件的效果一样</p></li><li><p>文件描述符闭包 <code>N>&-</code> 的效果与删除符号链接<code>/proc/self/fd/N</code> 一样</p></li><li><p>当前命令被执行</p></li></ul></li><li><p><code>&>FILE</code> 的作用是同时将标准输出和标准错误重定向到指定文件，它与 <code>> FILE 2>&amp;1</code> 等价。</p></li><li><p>连接符（<code>-</code>）的作用是告知程序从管道读取输入。</p></li><li></li></ul><h1 id=捕捉信号>捕捉信号</h1><ul><li><p>不同 Linux 发行版支持的信号（signal）可能不同，可以使用 <code>man -k signal</code> 命令查看系统支持的信号。</p></li><li><p>使用 shell 发送控制信号</p><ul><li><strong>Control signals in Bash</strong><table><thead><tr><th>Standard key combination</th><th>Meaning</th><th></th></tr></thead><tbody><tr><td><strong>Ctrl</strong>+<strong>C</strong></td><td>The interrupt signal, sends SIGINT to the job running in the foreground.</td><td></td></tr><tr><td><strong>Ctrl</strong>+<strong>Y</strong></td><td>The <em>delayed suspend</em> character. Causes a running process to be stopped when it attempts to read input from the terminal. Control is returned to the shell, the user can foreground, background or kill the process. Delayed suspend is only available on operating systems supporting this feature.</td><td></td></tr><tr><td><strong>Ctrl</strong>+<strong>Z</strong></td><td>The <em>suspend</em> signal, sends a <em>SIGTSTP</em> to a running program, thus stopping it and returning control to the shell.</td><td></td></tr></tbody></table></li></ul></li><li><p>我们经常使用 <code>kill</code> 来杀死一个进程，而根据 <code>kill</code> 命令中信号的不同，程序结束的行为也会有所差异。常见的 <code>kill</code> 信号有：</p><ul><li><table><thead><tr><th>Signal name</th><th>Signal value</th><th>Effect</th></tr></thead><tbody><tr><td>SIGHUP</td><td>1</td><td>Hangup</td></tr><tr><td>SIGINT</td><td>2</td><td>Interrupt from keyboard</td></tr><tr><td>SIGKILL</td><td>9</td><td>Kill signal</td></tr><tr><td>SIGTERM</td><td>15</td><td>Termination signal</td></tr><tr><td>SIGSTOP</td><td>17,19,23</td><td>Stop the process</td></tr></tbody></table></li></ul></li><li><p>在杀死一个或一批进程时，<code>SIGTERM</code> 信号是相对安全的，因为被杀死的进程可以在退出前执行收尾操作，比如清理数据、关闭文件等。而 <code>SIGKILL</code> 就不会给进程执行收尾操作的机会，可能导致异常。</p></li></ul><h1 id=worth-to-read>Worth to Read</h1><ul><li><p><a href=https://tldp.org/LDP/Bash-Beginners-Guide/html/index.html target=_blank>Bash Guide for Beginners</a>
.</p></li><li><p><a href=https://tldp.org/LDP/abs/html/index.html target=_blank>Advanced Bash-Scripting Guide</a>
.</p></li></ul></div><hr><aside><h4>No linked references</h4></aside><br><aside class=related></aside></article></div><div x-cloak x-data="{ atTop: false }"><button id=scrollToTop name="scroll to top button" aria-label="scroll to top button" class="fixed z-50 w-10 h-10 font-bold text-center text-white transition-all duration-1000 ease-in-out transform bg-violet-600 rounded-full cursor-pointer animate-bounce bottom-24 right-8 focus:outline-none" :class="{ 'opacity-0 translate-y-24': !atTop, 'opacity-1 translate-y-2' :  atTop}" @click="window.scrollTo({ top: 0, behavior: 'smooth'})" @scroll.window="atTop = (window.pageYOffset > 200)"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 11l3-3m0 0 3 3m-3-3v8m0-13a9 9 0 110 18 9 9 0 010-18z"/></svg></button></div><script src=https://zhannicholas.github.io/js/alpine.js defer></script>
<script src=https://zhannicholas.github.io/js/darkmode.js defer></script><footer class=bg-gray-900><div class="max-w-md px-4 py-12 mx-auto overflow-hidden sm:max-w-3xl sm:px-6 lg:max-w-7xl lg:px-8"><nav class="flex flex-wrap justify-center -mx-5 -my-2" aria-label=Footer><div class="px-5 py-2"><a href=https://zhannicholas.github.io/about class="text-base text-gray-400 hover:text-gray-300">About</a></div><div class="px-5 py-2"><a href=https://zhannicholas.github.io/posts class="text-base text-gray-400 hover:text-gray-300">Posts</a></div><div class="px-5 py-2"><a href=https://zhannicholas.github.io/pages class="text-base text-gray-400 hover:text-gray-300">Notes</a></div><div class="px-5 py-2"><a href=https://zhannicholas.github.io/library class="text-base text-gray-400 hover:text-gray-300">Library</a></div><div class="px-5 py-2"><a href=https://zhannicholas.github.io/contact/ class="text-base text-gray-400 hover:text-gray-300">Contact</a></div></nav><div class="flex justify-center mt-2 space-x-6"><a href=https://github.com/zhannicholas class="text-gray-400 hover:text-gray-300"><span class=sr-only>GitHub</span><svg class="w-6 h-6" fill="currentcolor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483.0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951.0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65.0.0.84-.27 2.75 1.026A9.564 9.564.0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688.0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855.0 1.338-.012 2.419-.012 2.747.0.268.18.58.688.482A10.019 10.019.0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"/></svg></a>
<a href=mailto:zhan_nicholas@outlook.com class="text-gray-400 hover:text-gray-300"><span class=sr-only>Email</span><svg class="w-6 h-6" fill="currentcolor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M21 7.38246601V5H3V7.38199365l9.0000224 4.50046115L21 7.38246601zm0 2.23606798-9.0000224 4.50001121L3 9.61810635V19H21V9.61853399zM3 3H21c1.1045695.0 2 .8954305 2 2V19c0 1.1045695-.8954305 2-2 2H3c-1.1045695.0-2-.8954305-2-2V5c0-1.1045695.8954305-2 2-2z" clip-rule="evenodd"/></svg></a>
<a href=https://t.me/zhannicholas class="text-gray-400 hover:text-gray-300"><span class=sr-only>Telegram</span><svg class="w-6 h-6" fill="currentcolor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.78754 14.0196C5.83131 14.0344 5.87549 14.0448 5.91963 14.0512 5.96777 14.1644 6.02996 14.3107 6.10252 14.4818c.17707.4176.41566.9825.66194 1.5717C7.2667 17.2552 7.77332 18.4939 7.88521 18.8485 8.02372 19.2868 8.17013 19.5848 8.32996 19.7883 8.4126 19.8935 8.50819 19.9853 8.62003 20.0549 8.67633 20.0899 8.7358 20.1186 8.79788 20.14 8.80062 20.141 8.80335 20.1419 8.80608 20.1428 9.1261 20.2636 9.41786 20.2133 9.60053 20.1518 9.69827 20.1188 9.77735 20.0791 9.8334 20.0469 9.86198 20.0304 9.88612 20.0151 9.90538 20.0021L9.90992 19.9991l2.82618-1.7625 3.2646 2.5028C16.0488 20.7763 16.1014 20.8073 16.157 20.8316 16.5492 21.0027 16.929 21.0624 17.2862 21.0136 17.6429 20.9649 17.926 20.8151 18.1368 20.6464 18.3432 20.4813 18.4832 20.2963 18.5703 20.1589 18.6148 20.0887 18.6482 20.0266 18.6718 19.9791 18.6836 19.9552 18.6931 19.9346 18.7005 19.9181L18.7099 19.8963 18.7135 19.8877 18.715 19.8841 18.7156 19.8824 18.7163 19.8808C18.7334 19.8379 18.7466 19.7935 18.7556 19.7482L21.7358 4.72274C21.7453 4.67469 21.7501 4.62581 21.7501 4.57682 21.7501 4.13681 21.5843 3.71841 21.1945 3.46452 20.8613 3.24752 20.4901 3.23818 20.2556 3.25598 20.0025 3.27519 19.7688 3.33766 19.612 3.38757 19.5304 3.41355 19.4619 3.43861 19.4126 3.45773 19.3878 3.46734 19.3675 3.47559 19.3523 3.48188L19.341 3.48666 2.62725 10.0432 2.62509 10.044C2.61444 10.0479 2.60076 10.053 2.58451 10.0593 2.55215 10.0719 2.50878 10.0896 2.45813 10.1126 2.35935 10.1574 2.22077 10.2273 2.07856 10.3247c-.22719.1556-.74968.5817-.6617 1.285.07019.5611.45457.9057.68876 1.0714C2.23421 12.7721 2.35638 12.8371 2.44535 12.8795 2.48662 12.8991 2.57232 12.9339 2.6095 12.9491L2.61889 12.9529l3.16865 1.0667zM19.9259 4.86786 19.9236 4.86888C19.9152 4.8725 19.9069 4.87596 19.8984 4.87928L3.1644 11.4438C3.15566 11.4472 3.14686 11.4505 3.138 11.4536L3.12869 11.4571C3.11798 11.4613 3.09996 11.4686 3.07734 11.4788 3.06451 11.4846 3.05112 11.491 3.03747 11.4978 3.05622 11.5084 3.07417 11.5175 3.09012 11.5251 3.10543 11.5324 3.11711 11.5374 3.1235 11.54l3.14263 1.058C6.32365 12.6174 6.37727 12.643 6.42649 12.674L16.8033 6.59948 16.813 6.59374C16.8205 6.58927 16.8305 6.58353 16.8424 6.5768 16.866 6.56345 16.8984 6.54568 16.937 6.52603 17.009 6.48938 17.1243 6.43497 17.2541 6.39485 17.3444 6.36692 17.6109 6.28823 17.899 6.38064 18.0768 6.43767 18.2609 6.56028 18.3807 6.76798 18.4401 6.87117 18.4718 6.97483 18.4872 7.06972 18.528 7.2192 18.5215 7.36681 18.4896 7.49424 18.4208 7.76875 18.228 7.98287 18.0525 8.14665 17.9021 8.28706 15.9567 10.1629 14.0376 12.0147 13.0805 12.9381 12.1333 13.8525 11.4252 14.5359l-.465.449 5.8719 4.5018C16.9668 19.5349 17.0464 19.5325 17.0832 19.5274 17.1271 19.5214 17.163 19.5045 17.1997 19.4752 17.2407 19.4424 17.2766 19.398 17.3034 19.3557L17.3045 19.354 20.195 4.78102C20.1521 4.79133 20.1087 4.80361 20.0669 4.81691 20.0196 4.83198 19.9805 4.84634 19.9547 4.85637 19.9418 4.86134 19.9326 4.86511 19.9276 4.86719L19.9259 4.86786zM11.4646 17.2618 10.2931 16.3636 10.0093 18.1693 11.4646 17.2618zM9.21846 14.5814l1.16494-1.1247c.7081-.6835 1.6555-1.5979 2.6127-2.5215l.9725-.9382-6.52007 3.8168L7.48351 13.8963c.1777.4191.41736.9864.664940000000001 1.5788.185129999999999.4429.37872.9093.55504 1.3411l.28304-1.8004C9.01381 14.8422 9.09861 14.692 9.21846 14.5814z" clip-rule="evenodd"/></svg></a></div><p class="mt-2 text-base text-center text-gray-400">2018-2023 &copy; Nicholas Zhan. Licensed under <a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/>CC BY-NC 4.0</a>.</p><p class="mt-2 text-base text-center text-gray-400">Powered by <a href=https://gohugo.io/>Hugo</a> and <a href=https://github.com/sawhney17/logseq-schrodinger>logseq-schrodinger</a>.</p></div></footer></body></html>