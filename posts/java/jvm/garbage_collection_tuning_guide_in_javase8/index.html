<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=content-type content="text/html" charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon type=image/png sizes=32x32 href=https://zhannicholas.github.io/images/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=https://zhannicholas.github.io/images/favicon/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=https://zhannicholas.github.io/images/favicon/favicon-16x16.png><meta name=theme-color content="#ffffff"><title itemprop=name>垃圾回收调优指南(Java SE 8)</title><meta property="og:title" content="垃圾回收调优指南(Java SE 8)"><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta itemprop=name content="垃圾回收调优指南(Java SE 8) NZ's Digital Garden"><meta name=application-name content="垃圾回收调优指南(Java SE 8) NZ's Digital Garden"><meta name=author content="Nicholas Zhan"><meta name=description content><meta itemprop=description content><meta name=url content="https://zhannicholas.github.io/posts/java/jvm/garbage_collection_tuning_guide_in_javase8/"><link rel=canonical href=https://zhannicholas.github.io itemprop=url><script type=application/ld+json>{"@context":"https://schema.org","@type":"Dentist","name":"NZ\u0027s Digital Garden","description":"","slogan":"","openingHours":"","telephone":"","email":"","vatID":"","url":"https:\/\/zhannicholas.github.io","logo":"https:\/\/zhannicholas.github.io/images/logo_small.png","image":"https:\/\/zhannicholas.github.io/images/logo_full.png","address":{"@type":"PostalAddress","streetAddress":" ","addressLocality":"","addressRegion":"","postalCode":"","addressCountry":""},"geo":{"@type":"GeoCoordinates","latitude":"","longitude":""},"sameAs":[]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/zhannicholas.github.io"},{"@type":"ListItem","position":3,"name":"Posts","item":"https:\/\/zhannicholas.github.io\/posts\/"},{"@type":"ListItem","position":4,"name":"Java","item":"https:\/\/zhannicholas.github.io\/posts\/java\/"},{"@type":"ListItem","position":5,"name":"Jvm","item":"https:\/\/zhannicholas.github.io\/posts\/java\/jvm\/"},{"@type":"ListItem","position":6,"name":"Garbage Collection Tuning Guide in Javase8","item":"https:\/\/zhannicholas.github.io\/posts\/java\/jvm\/garbage_collection_tuning_guide_in_javase8\/"}]}</script><link rel=preconnect href=https://fonts.googleapis.com><link rel=stylesheet href="/css/main.min.710986944c2e6da1b8df15c5e0c7999affdc4e9ebac27cc9e6df4208f465c990609147ac1865f2be657443a9658b90c9492b300f4990327501d2b36e9be544f8.css" integrity="sha512-cQmGlEwubaG43xXF4MeZmv/cTp66wnzJ5t9CCPRlyZBgkUesGGXyvmV0Q6lli5DJSSswD0mQMnUB0rNum+VE+A==" media=screen><script type=module>
  import Alpine from '/js/alpinejs.js';
  window.Alpine = Alpine;
  Alpine.start();
</script><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(console.log("add dark"),document.documentElement.classList.add("dark")):(console.log("remove dark"),document.documentElement.classList.remove("dark"))</script></head><body class="bg-zinc-100 dark:bg-gray-800"><div class="top-0 z-50 w-full text-gray-200 bg-gray-900 border-2 border-gray-900 md:sticky border-b-stone-200/10"><div x-data="{ open: false }" class="flex flex-col max-w-full px-4 mx-auto md:items-center md:justify-between md:flex-row md:px-6 lg:px-8"><div class="flex flex-row items-center justify-between p-4"><a href=https://zhannicholas.github.io/ class="flex text-gray-100 transition duration-1000 ease-in-out group"><img src=https://zhannicholas.github.io/images/site-logo.svg class="transition-opacity h-9 w-9 group-hover:opacity-50 group-focus:opacity-70" alt="'s Digital Garden Logo"><div class="mt-1 text-xl font-black tracking-tight text-gray-100 uppercase transition-colors group-hover:text-gray-400/60">'s Digital Garden</div></a><button class="rounded-lg md:hidden focus:outline-none focus:shadow-outline" @click="open = !open" role=navigation aria-expanded=false aria-label=Main aria-controls=menuItems><svg fill="currentcolor" viewBox="0 0 20 20" class="w-6 h-6"><path x-show="!open" fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4A1 1 0 013 5zm0 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm6 5a1 1 0 011-1h6a1 1 0 110 2h-6a1 1 0 01-1-1z" clip-rule="evenodd"/><path x-show="open" fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414.0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/></svg></button></div><nav :class="{'flex': open, 'hidden': !open}" class="flex-col flex-grow hidden pb-4 md:pb-0 md:flex md:justify-end md:flex-row"><div @click.away="open = false" class=relative x-data="{ open: false }"><button @click="open = !open" class="flex flex-row items-center w-full px-4 py-2 mt-2 text-sm font-semibold text-left bg-transparent rounded-lg md:w-auto md:inline md:mt-0 md:ml-4 hover:text-white focus:text-white hover:bg-indigo-600 focus:bg-indigo-600 focus:outline-none focus:shadow-outline">
<span>The Garden</span><svg fill="currentcolor" viewBox="0 0 20 20" :class="{'rotate-180': open, 'rotate-0': !open}" class="inline w-4 h-4 mt-1 ml-1 transition-transform duration-200 transform md:-mt-1"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414.0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414.0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/></svg></button><div x-show=open x-transition:enter="transition ease-out duration-100" x-transition:enter-start="transform opacity-0 scale-95" x-transition:enter-end="transform opacity-100 scale-100" x-transition:leave="transition ease-in duration-75" x-transition:leave-start="transform opacity-100 scale-100" x-transition:leave-end="transform opacity-0 scale-95" class="absolute right-0 z-30 w-full mt-2 origin-top-right rounded-md shadow-lg md:w-48"><div class="px-2 py-2 text-indigo-900 bg-white rounded-md shadow"><a class="block px-4 py-2 mt-2 text-sm font-semibold bg-transparent rounded-lg md:mt-0 hover:text-white focus:text-white hover:bg-indigo-600 focus:bg-indigo-600 focus:outline-none focus:shadow-outline" href=https://zhannicholas.github.io/posts/>Posts</a>
<a class="block px-4 py-2 mt-2 text-sm font-semibold bg-transparent rounded-lg md:mt-0 hover:text-white focus:text-white hover:bg-indigo-600 focus:bg-indigo-600 focus:outline-none focus:shadow-outline" href=https://zhannicholas.github.io/notes/>Notes</a>
<a class="block px-4 py-2 mt-2 text-sm font-semibold bg-transparent rounded-lg md:mt-0 hover:text-white focus:text-white hover:bg-indigo-600 focus:bg-indigo-700 focus:outline-none focus:shadow-outline" href=https://zhannicholas.github.io/library/>Library</a></div></div></div><a class="px-4 py-2 mt-2 text-sm font-semibold rounded-lg md:mt-0 md:ml-4 hover:text-white focus:text-white hover:bg-indigo-600 focus:bg-indigo-700 focus:outline-none focus:shadow-outline" href=https://zhannicholas.github.io/now/>Now</a>
<a class="px-4 py-2 mt-2 text-sm font-semibold bg-transparent rounded-lg md:mt-0 md:ml-4 hover:text-white focus:text-white hover:bg-indigo-600 focus:bg-indigo-700 focus:outline-none focus:shadow-outline" href=https://zhannicholas.github.io/about/>About</a>
<button id=theme-toggle type=button class="p-2 text-sm text-gray-500 rounded-lg md: dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 md:ml-2 max-w-5 xs:hidden"><svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentcolor" viewBox="0 0 20 20" aria-label="Dark or Light Mode" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></nav></div></div><div class=content><article><header class="max-w-2xl mx-auto mb-4 bg-indigo-600"><span class=py-96><h1 class="px-6 pt-6 pb-16 mx-auto dark:prose-invert text-5xl font-black text-center text-white capitalize">垃圾回收调优指南(Java SE 8)</h1></span></header><div class="max-w-4xl mx-auto mt-8 mb-2"><div class=px-6></div></div><div class="fixed z-20 top-[3.8125rem] bottom-0 right-[max(0px,calc(50%-45rem))] w-[18rem] py-10 overflow-y-auto hidden xl:block"><nav><div class="flex items-center"><h2 class="pl-2 my-0 text-xl font-medium text-zinc-800 uppercase break-words">Table of Contents</h2></div><div class="absolute top-auto bottom-auto right-auto p-0 -left-4" role=menu><div class="relative z-50 max-w-sm m-4 overflow-hidden shadow-lg"><ul class="relative p-4 overflow-x-hidden overflow-y-auto overscroll-y-auto overscroll-x-auto"><li><a class="px-2 text-left text-zinc-700 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#ergonomics>Ergonomics</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%9f%ba%e4%ba%8e%e8%a1%8c%e4%b8%ba%e7%9a%84%e8%b0%83%e4%bc%98>基于行为的调优</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e6%9c%80%e5%a4%a7%e6%9a%82%e5%81%9c%e6%97%b6%e9%97%b4>最大暂停时间</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%90%9e%e5%90%90%e9%87%8f>吞吐量</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%86%85%e5%ad%98%e5%8d%a0%e7%94%a8>内存占用</a></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e8%b0%83%e4%bc%98%e7%ad%96%e7%95%a5>调优策略</a></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%88%86%e4%bb%a3>分代</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e8%ae%be%e7%bd%ae%e5%88%86%e4%bb%a3%e5%a4%a7%e5%b0%8f>设置分代大小</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e6%95%b4%e4%b8%aa%e5%a0%86>整个堆</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%b9%b4%e8%bd%bb%e4%bb%a3>年轻代</a></li></ul></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%8f%af%e7%94%a8%e6%94%b6%e9%9b%86%e5%99%a8>可用收集器</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%a6%82%e4%bd%95%e9%80%89%e6%8b%a9-gc>如何选择 GC</a></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%b9%b6%e8%a1%8c%e6%94%b6%e9%9b%86%e5%99%a8>并行收集器</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%88%86%e4%bb%a3-1>分代</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#parallel-collector-ergonomics>Parallel Collector Ergonomics</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e7%9b%ae%e6%a0%87%e4%bc%98%e5%85%88%e7%ba%a7>目标优先级</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e8%b0%83%e6%95%b4%e5%88%86%e4%bb%a3%e5%a4%a7%e5%b0%8f>调整分代大小</a></li></ul></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%b9%b6%e5%8f%91%e6%94%b6%e9%9b%86%e5%99%a8>并发收集器</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#cms-%e6%94%b6%e9%9b%86%e5%99%a8>CMS 收集器</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%b9%b6%e5%8f%91%e6%a8%a1%e5%bc%8f%e5%a4%b1%e8%b4%a5>并发模式失败</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#gc-%e6%97%b6%e9%97%b4%e8%bf%87%e9%95%bf%e4%b8%8e-outofmemoryerror>GC 时间过长与 OutOfMemoryError</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e6%b5%ae%e5%8a%a8%e5%9e%83%e5%9c%be>浮动垃圾</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%b9%b6%e5%8f%91%e5%9b%9e%e6%94%b6%e4%bd%95%e6%97%b6%e5%bc%80%e5%a7%8b>并发回收何时开始</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%a2%9e%e9%87%8f%e6%a8%a1%e5%bc%8f>增量模式</a></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#g1-%e6%94%b6%e9%9b%86%e5%99%a8>G1 收集器</a><ul><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e6%b5%ae%e5%8a%a8%e5%9e%83%e5%9c%be-1>浮动垃圾</a></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%8d%a1%e8%a1%a8>卡表</a></li></ul></li></ul></li><li><a class="px-2 text-left text-zinc-900 rounded-md focus:outline-none hover:bg-lightBlue-600 hover:text-white" x-data href=#%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99>参考资料</a></li></ul></div></div></nav></div><div class="max-w-2xl px-6 pt-6 pb-16 mx-auto prose dark:prose-invert dark:text-white"><blockquote><p>这篇笔记地主要内容来自<a href=https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/introduction.html target=_blank>Java Platform, Standard Edition HotSpot Virtual Machine Garbage Collection Tuning Guide</a>
。文章中介绍了一些调优目标以及 JDK 8中 Hotspot VM 提供的一些垃圾收集器，并提出了很多调优建议。</p></blockquote><p><strong>GC（Garbage Collector）</strong> 是一个内存管理工具，它通过以下操作实现了自动内存管理：</p><ol><li>将新生对象分配到 <strong>年轻代（Young Generation）</strong>，并将足够老的对象提升到 <strong>年老代（Old Generation）</strong>。</li><li>通过并发（或并行）标记阶段找出年老代中的存活对象。当整个 Java 堆的空间使用率超过阈值时，HotSpot VM 就会触发标记阶段。</li><li>通过并行复制整理存活对象，以释放堆空间，恢复可用内存。</li></ol><h2 id=ergonomics>Ergonomics</h2><blockquote><p><em>Ergonomics</em> is the process by which the Java Virtual Machine (JVM) and garbage collection tuning, such as behavior-based tuning, improve application performance.</p></blockquote><p>JVM 会根据所运行平台选择默认的 GC、堆大小和运行时编译器等。此外，基于行为的调优会动态地调整堆大小以满足不同应用的要求。</p><h3 id=基于行为的调优>基于行为的调优</h3><p>Java SE 为 <em>并行收集器</em> 提供了两个参数以实现不同的应用行为：<strong>最大暂停时间（maximum pause time goal）</strong> 和 <strong>吞吐量（application throughput goal）</strong>。这两个参数在其它收集器中是不可用的。在某些时候，预期行为可能不会出现，因为应用需要一个至少能存放下所有存活对象的堆空间。对堆空间的最小要求可能会妨碍达成预期目标。</p><h4 id=最大暂停时间>最大暂停时间</h4><p>暂停时间指的是 GC 停止应用并回收内存所花费的时间。GC 会维护一个平均暂停时间以及这个平均暂停时间上的方差，平均暂停时间是加权的，越晚发生的停顿权重越大。当平均暂停时间与方差之和大于最大暂停时间时，HotSpot就认为GC没有满足最大暂停时间的要求。</p><p>最大暂停时间目标是通过命令行参数 <code>-XX:MaxGCPauseMillis=&lt;nnn></code> 来指定，它告诉 GC 期望的暂停时间不应该超过 <code>&lt;nnn></code> 毫秒。为了达到这个目标，GC 会调整堆的大小以及其它相关参数，这些调整可能会让 GC 的执行更加频繁，从而有可能降低程序的吞吐量。GC 会优先满足最大暂停时间目标而不是吞吐量目标，但有时候可能连暂停时间目标也满足不了。</p><h4 id=吞吐量>吞吐量</h4><p>吞吐量是用 GC 时间和非 GC 时间(应用时间)来衡量的，相关的命令行参数是 <code>-XX:GCTimeRatio=&lt;nnn></code>。GC 时间与应用时间的比值为 <code>1/(1 + &lt;nnn>)</code>。例如，<code>-XX:GCTimeRatio=19</code> 表示 GC 时间占总时间的 5%。</p><p>GC 时间为年轻代与年老代 GC 时间的总和。如果吞吐量目标没有满足，GC 会增大分代的大小，从而使应用能在两次垃圾收集之间的执行更久。</p><h4 id=内存占用>内存占用</h4><p>当最大暂停时间和吞吐量都达到要求后，GC 会缩小整个堆空间直到某个目标（当前版本 JVM 中总是指吞吐量）不再满足，然后再尝试满足那个目标。</p><h3 id=调优策略>调优策略</h3><ul><li>除非你知道你所需要的堆空间比默认最大堆大小还要大，否则不要设置最大堆内存，而是为你的应用设置一个足够大的吞吐量目标。</li><li>为了使应用达到期望的吞吐量，堆的通常会自动扩容和缩容。应用行为的改变也可能导致堆容量的改变。</li><li>如果堆已经达到了最大值，而吞吐量仍然低于期望值，那么你的最大堆内存就设置得太小了。这个时候，将最大堆内存设置为一个稍小于总物理内存的值，再次运行应用，如果吞吐量还是低于期望值，那么你的吞吐量目标就定得太高了（已经超过物理内存所能提供的最大吞吐量了）。</li><li>如果吞吐量目标达到了，但应用的暂停时间太长了，就设置一个最大暂停时间目标。为了达到最大暂停时间目标，期望的吞吐量可能又无法达到了，这个时候，需要进行权衡，选择一个折中的目标。</li><li>GC 为了达到设置的目标，通常会引起堆大小的振荡，即使应用已经处于一个稳定状态也一样。最大吞吐量目标与最大暂停时间目标和内存占用目标时相互竞争的，因为前者可能需要更大的堆，而后两者可能需要的是更小的堆。</li></ul><h2 id=分代>分代</h2><p>人们从经验中发现，绝大多数应用都具备一些共同的特点。为了使垃圾回收过程更加高效，分代收集利用了这些特点，其中最重要的一条就是 <strong>弱分代假说（weak generational hypothesis）</strong> ——大多数对象的存活时间都非常短。内存以代的形式进行管理，代实际上是一个存放有不同年龄对象的内存池。当某个代被填满时，该代上面的垃圾回收就会发生。</p><p>下图展示了 GC 中（不包括并行收集器和 G1）默认的堆布局:</p><p><img src=https://zhannicholas.github.io/images/java/jvm/default-arrangement-of-generations-except-for-parallel-collector-and-g1.png alt="Default Arrangement of Generations, Except for Parallel Collector and G1"></p><h3 id=设置分代大小>设置分代大小</h3><p>有很多参数可以影响堆的大小。下图展示了堆中 <em>已提交空间（committed space）</em> 与 <em>虚拟空间（virtual space）</em> 的区别：</p><p><img src=https://zhannicholas.github.io/images/java/jvm/heap-parameters.png alt="Heap Parameters"></p><p><code>-Xmx</code> 用来指定堆的保留空间，如果 <code>-Xms</code> 参数的值比它小，那么并不是所有的保留空间都会被立即提交给 JVM，其中未提交的部分就是上图中用Virtual 标出来的那一部分。堆的不同部分（年轻代和年老代）可以按需扩张，直到达到虚拟空间的上限。</p><h4 id=整个堆>整个堆</h4><p>下面所讨论的堆容量的扩张与收缩和默认堆大小并不适用于并行收集器，然而控制堆大小和分代大小的参数却是适用于并行收集器的。最影响垃圾回收性能的因素就是可用内存的总大小，因为垃圾收集在堆被填满时才发生，所以垃圾回收的吞吐量与可用内存总大小成反比。</p><p>默认情况下，JVM 会在每次进行垃圾回收时扩张或缩减堆的容量，以便将空闲空间与存活对象的比值限制在一个特定范围（百分比）内，这个范围是通过参数 <code>-XX:MinHeapFreeRatio=&lt;minimun></code> 和 <code>-XX:MaxHeapFreeRatio=&lt;maximum></code> 来设置的，而整个堆的大小边界是通过参数 <code>-Xms&lt;min></code> 和 <code>-Xmx&lt;max></code> 来确定的。如果某个分代中空闲空间的比例低于 <code>&lt;minimum></code>，该分代就会扩张，从而将空闲空间的比例保持在 <code>&lt;minimum></code>。类似地，如果空闲空间的比例高于 <code>&lt;maximum></code>，该分代就会被收缩，从而将空闲空间的比例保持在 <code>&lt;maximum></code>，不过这受限于分代的最小容量。</p><p>下面是一些服务端应用中有关堆大小的通用准则：</p><ul><li>除非暂停时间成为了你的最大问题，就尝试分配尽可能多的内存给 JVM。默认值通常都太小了。</li><li>将 <code>-Xms</code> 和 <code>-Xmx</code> 设为相同值，从而避免 JVM 对堆进行扩容或缩容。但是，如果你的设置不当的话，JVM 是不会帮你救你的。</li><li>通常情况下，当你增加处理器时，你也应该增加可用内存，因为内存分配可以是并行的。</li></ul><h4 id=年轻代>年轻代</h4><p>除可用内存大小之外，第二个最影响垃圾回收性能的就是年轻代占堆空间的比例了。通常，年轻代越大，minor GC 发生的频率就越低。然而，在有限的堆空间下，年轻代越大就意味着年老代越小。而通常情况下，年老代越小，major GC 就越频繁。因此，最优的设置取决于应用中对象存活时间的分布情况。</p><p>默认情况下，年轻代的大小由参数 <code>NewRatio</code> 控制。例如，<code>-XX:NewRatio=3</code> 表示年轻代与年老代的比例为 1:3，即年轻代占整个堆空间的 1/4。<code>NewSize</code> 和 <code>MaxNewSize</code> 参数用来指定年轻代容量的下限与上限，两者的值相同会使年轻代的大小保持不变。</p><h5 id=调整-survivor-空间的大小>调整 Survivor 空间的大小</h5><p>我们可以使用 <code>SurvivorRatio</code> 参数来调整 Survivor 空间的大小，但这通常不会给性能带来多大的影响。例如，<code>-XX:SurvivorRatio=6</code> 表示一个 Survivor 空间与 Eden 区大小之比为 1:6，即每个 Survivor 空间的大小为 Eden 区的 1/6，为年轻代的 1/8。</p><p>若 Survivor 空间过小，复制回收时溢出的对象就会直接被提升到年老代；若 Survivor 空间过大，就会造成空间的浪费。在每次垃圾回收中，JVM都会选择一个阈值（对象在被提升到年老代之前可以被复制的次数），这个阈值的目的是将 Survivor 空间的占用率保持在 50%。</p><p>对服务端应用而言，下面是一些通用准则：</p><ul><li>先决定能够分配给 JVM 的最大堆内存，然后找出年轻代的最佳设置值。<ul><li>注意：最大堆内存应该总是小于机器已安装内存，这样可以避免过多的页错误和颠簸。</li></ul></li><li>如果堆大小是固定的，那么增大年轻代就会缩小年老代。将年老代的大小保持在一个足够大的值，以便它在任何时候都能容纳下应用中的存活对象，并且还有一些松弛空间（10% 到 20% 甚至更多）。</li><li>在之前所陈述的永久代的约束条件下：<ul><li>为年轻代分配足够的内存。</li><li>当你增加处理器时，你也应该增加年轻代的大小，因为内存分配可以是并行的。</li></ul></li></ul><h2 id=可用收集器>可用收集器</h2><p>Java HotSpot VM 包含三种不同类型的 GC，每种 GC 都有不同的性能特征：</p><ul><li><strong>串行收集器（serial collector）</strong> 使用一个线程完成所有的回收工作，由于不存在线程间通信的开销，它还是相对高效的。串行收集器最适合用在单处理器机器上，因为它无法利用多处理器机器上的多个 CPU，尽管它对多处理器上运行的小型应用（内存最大约100MB）来说还是很有用的。串行收集器在某些硬件和操作系统配置下会默认启用，也可以通过 <code>-XX:+UseSerialGC</code> 选项显式使用它。</li><li><strong>并行收集器（parallel collector）</strong> 又称 <strong>吞吐量收集器（throughput collector）</strong>，它并行的进行 minor GC，这能显著降低 GC 的开销。它是为运行在多处理器硬件上的中大型应用准备的。并行收集器也是某些硬件和操作系统配置下的默认 GC，我们也可以通过 <code>-XX:+UseParallelGC</code> 选项显式使用它。<ul><li><strong>并行整理（parallel compaction）</strong> 使并行收集器能够并行进行 major GC。如果没有并行整理，major GC 就会使用单线程以串行地方式进行，这极大的限制了应用地可伸缩性。当 <code>-XX:+UseParallelGC</code> 选项被使用时，并行整理会被默认启用。若要关闭它，可以使用 <code>-XX:-UseParallelOldGC</code> 选项。</li></ul></li><li><strong>并发收集器（mostly concurrent collector）</strong> 的大部分工作都是并发进行的，从而使应用被暂停的时间保持在一个较短的范围内。并发收集器为那些响应时间优于吞吐量的中大型应用设计的，因为用来减小暂停时间的技术同时会降低吞吐量。HotSpot VM 提供了两个最大并发收集器：<ul><li>CMS：通过 <code>-XX:+UseConcMarkSweepGC</code> 启用。</li><li>G1：通过 <code>-XX:+UseG1GC</code> 启用。</li></ul></li></ul><h3 id=如何选择-gc>如何选择 GC</h3><p>除非你的应用对暂停时间有非常严苛的要求，否则先运行应用并让 JVM 自己选择一个 GC。按需调整堆的大小以提高性能，如果期望的性能无法满足，就使用下面的准则选择 GC：</p><ul><li>如果应用很小（堆空间不超过 100MB），使用 <code>-XX:+UseSerialGC</code> 选择串行收集器。</li><li>如果应用运行在单处理器上且对暂停时间无要求，就让 JVM 自己选择 GC，或者选择串行收集器（<code>-XX:+UseSerialGC</code>）。</li><li>如果应用的峰值性能最为重要，且对暂停时间无要求或暂停 1 秒及以上时间是可接受的，就选择并行收集器（<code>-XX:+UseParallelGC</code> ）。</li><li>如果响应时间比总吞吐量更重要，且暂停时间必须保持在约 1 秒内，就选择并发收集器（<code>-XX:+UseConcMarkSweepGC</code> 或 <code>-XX:+UseG1GC</code>）。</li></ul><p>如果采用了推荐的 GC，但应用还是达不到期望的性能，先尝试调整分代的大小。如果还是不行，就再尝试不同 GC：在多处理器上，用并发收集器减小暂停时间，用并行收集器提升吞吐量。</p><h2 id=并行收集器>并行收集器</h2><p>并行收集器和串行收集器类似，主要不同在于它采用了多个线程以加速回收垃圾。GC 线程的数量可以通过命令行参数 <code>-XX:ParallelGCThreads=&lt;N></code> 来指定。</p><h3 id=分代-1>分代</h3><p>之前有提到，并行收集器中的堆布局和普通的串行收集器是不同的。下图展示了并行收集器中的分代布局：</p><p><img src=https://zhannicholas.github.io/images/java/jvm/arrangemant-of-generations-in-the-parallel-collector.png alt="Arrangement of Generations in the Parallel Collector"></p><h3 id=parallel-collector-ergonomics>Parallel Collector Ergonomics</h3><h4 id=目标优先级>目标优先级</h4><p>当使用并行收集器时，HotSpot VM 默认会按照以下顺序实现调优目标：</p><ol><li>最大暂停时间目标。</li><li>吞吐量目标。</li><li>最小内存占用目标。</li></ol><p>首先满足暂停时间目标，然后才会考虑吞吐量。当前面两个都满足时，才会考虑内存占用。</p><h4 id=调整分代大小>调整分代大小</h4><p>收集器会记录并在每次垃圾收集之后更新一些统计数据(如平均暂停时间)，这些统计数据会帮助GC判断是否已经达到调优目标或做出一些调整。需要注意的是：收集器并不会使用显式地进行垃圾回收（例如 <code>System.gc()</code>）时形成的数据。</p><p>分代容量的增长和缩减是以固定百分比进行的，并且增长率和缩减率不同。默认情况下，分代会以 20% 的增量扩容，而以 5% 的增量压缩。年轻代与年老代容量扩容的增量可以通过 <code>-XX:YoungGenerationSizeIncrement=&lt;Y></code> 与 <code>-XX:TenuredGenerationSizeIncrement=&lt;T></code> 来指定，而缩容的增量是通过 <code>-XX:AdaptiveSizeDecrementScaleFactor=&lt;D></code> 指定的。如果扩容的增量为X个百分比，则缩容的增量为 X/D 个百分比。</p><h2 id=并发收集器>并发收集器</h2><p>HotSpot VM 提供了两个 <strong>并发收集器（mostly concurrent collector）</strong>：</p><ul><li>Concurrent Mark Sweep (CMS) Collector：适用于那些偏爱更短的暂停时间并且可以接受同 GC 分享 CPU 的应用。</li><li>Garbage-First (G1) Collector：为拥有大内存的多处理机设计的面向服务端应用的收集器。它尝试在实现高吞吐量的同时大概率满足应用对暂停时间的要求。</li></ul><h3 id=cms-收集器>CMS 收集器</h3><p>通常情况下，那些有着相对较大的年老代并且运行在拥有 2 个或更多处理器的机器上的应用往往会从 CMS 收集器中获益。对于那些要求暂停时间非常短的应用来说，CMS 也是非常适合的。启用 CMS 收集器的命令行参数为 <code>-XX:+UseConcMarkSweepGC</code>。</p><p>和其它的 GC 类似，CMS 收集器也是基于分代的，因此 minor GC 和 major GC 都会发生。CMS 收集器试图通过使用独立的 GC 线程在应用线程执行期间并发地追踪可达对象来较少 major GC 引起的应用暂停时间。在每次 major GC 中，CMS 会在收集开始时（标记 GC Roots 直接可达的存活对象）短暂暂停所有应用线程，然后在收集过程中再次暂停（重新标记那些在并发标记中由于引用更新而漏标的对象）所有应用线程。第二次暂停通常比第一次暂停时间要长，在每次暂停期间，都会有多个线程同时进行垃圾收集相关工作。其余阶段（包括追踪存活对象和清除不可达对象）中，GC 线程都是在应用执行期间并发执行的。Minor GC 可以与正在进行的 major GC 重叠，工作方式也与并行收集器，但并行收集器在 minor GC 期间会暂停所有应用线程。</p><h4 id=并发模式失败>并发模式失败</h4><p>当 CMS 收集器无法在年老代空间耗尽之前完成回收不可达对象所占用的空间时，或者当 <em>赋值器（mutator）</em> 无法从年老代中为对象分配一个足够大的空闲块时，应用就会被暂停，GC会在所有应用暂停的情况下完成回收工作。<strong>并发模式失败（Concurrent Mode Failure）</strong> 指的就是 GC 无法 <em>并发地</em> 完成垃圾回收工作，这暗示我们该对 CMS 收集器进行调优了。</p><h4 id=gc-时间过长与-outofmemoryerror>GC 时间过长与 OutOfMemoryError</h4><p>CMS 收集器会在 GC 时间过长时抛出 OutOfMemoryError，即：当垃圾回收耗费的时间超过了总时间的 98%，并且回收的空间少于 2% 时，OutOfMemoryError 就会被抛出。这个特性是用来防止由于堆太小而导致应用运行时间太长，我们可以使用 <code>-XX:-UseGCOverheadLimit</code> 禁用它。</p><h4 id=浮动垃圾>浮动垃圾</h4><p>由于应用线程会在 major GC 之间并发地执行，GC 追踪到的存活对象可能在垃圾收集结束之前变得不再可达，这类对象在当前进行的这一次回收过程中并不会被回收，它们被称为 <strong>浮动垃圾（floating garbage）</strong>。浮动垃圾的数量取决于并发收集的持续时间以及对象引用更新的频率，不过这些浮动垃圾会在下一次垃圾回收过程中被回收掉。</p><h4 id=并发回收何时开始>并发回收何时开始</h4><p>串行收集器会在年老代被填满之后暂停应用并进行 major GC。与此相反，并发收集的开始时间必须提前确定，以便收集工作在年老代空间耗尽之前完成。否则，应用会由于并发模式失败而被长时间暂停。有几种开始并发收集的方式：</p><ul><li>基于历史数据，CMS 收集器会预估年老代还有多久被耗尽以及一次 major GC 会花多长时间。CMS 会以在年老代空间耗尽之前完成收集工作为目标开始进行垃圾回收，这些估算时间通常是保守的，因为并发模式失败的代价太高了。</li><li>当年老代中被占用的容量超过一个阈值时，垃圾收集工作也会开始。这个阈值默认约为 92%（可能在不同发行版本中做调整），我们可以通过 <code>XX:CMSInitiatingOccupancyFraction=&lt;N></code> 来指定这个阈值，其中 <code>&lt;N></code> 为一个范围在 (1, 100) 间的整数。</li></ul><h4 id=增量模式>增量模式</h4><blockquote><p>注意：增量模式在 Java SE 8 中正被弃用，将来的版本中可能会移除。</p></blockquote><h3 id=g1-收集器>G1 收集器</h3><p><strong>Garbage-First（G1）</strong> 收集器是一款面向服务端应用的收集器，目标为拥有大内存的多处理机。它尝试在实现高吞吐量的同时大概率满足应用对暂停时间的要求，这说明 G1 并不是一个实时 GC。</p><p>G1 将堆分成若干个大小相等的 <em>区域（region）</em>，每一个区域都是一个连续的虚拟地址空间。G1 通过并发标记阶段确定整个堆中对象的存活性，并发标记阶段完成后，G1 就知道哪些区域中的存活对象比较少了。它会先回收这些存活对象少的区域，而这通常可以为应用提供大量的空闲空间，这就是 G1（Garbage-First）名字的来源，即：G1 专注于收集和整理那些差不多被可回收对象（垃圾）占满的区域。</p><p>G1 会将堆中一个或多个区域中的存活对象复制到堆中的单个区域，复制过程中也会完成整理和释放空闲内存的工作。为了降低暂停时间并提升吞吐量，清空区域的操作在多处理机上是并行进行的。G1 采用的是“化整为零”的策略，在整理上比其它 GC 技高一筹：CMS 收集器不会整理堆，因而会导致内存碎片；并行收集器中的并行压缩过程是在整个堆上进行的，那会使暂停时间很可观。</p><p>值得注意的是：G1 并不是一款实时收集器，它大概率会满足暂停时间的要求，但并不是一定会满足。利用从已发生的垃圾回收中采集的数据，G1 会估计目标时间内能够回收区域的数量。G1 最关注的是如何为那些占用内存大且对 GC 延迟有要求的应用提供解决方案，这些应用的通常占用不低于 6GB 的堆空间，并且要求延迟时间低于 0.5 秒。</p><p>HotSpot 开发团队希望用 G1 来代替 CMS 收集器，它与 CMS 的主要不同点在于：G1 是一款整理式收集器。和 CMS 一样，G1 也是为那些要求低 GC 延迟的应用设计的。</p><p>下图展示了 G1 是如何划分堆的：</p><p><img src=https://zhannicholas.github.io/images/java/jvm/heap-division-by-g1.png alt="Heap Division by G1"></p><p>堆被划分为若干固定大小的区域（图中的灰色格子）。从逻辑上来讲，G1中依然有分代的概念。一组空闲区域被指定为逻辑年轻代（图中浅蓝色部分），分配操作就是从这个逻辑年轻代开始的。当年轻代满了之后，这组区域上的垃圾收集就会发生。有时候，这组区域以外的区域（年老区域，深蓝色）上的垃圾收集也会同时进行，这被称为 <strong>混合收集（mixed collection）</strong>。上图展示的正是混合收集，因为年轻区域和年老区域都正在被回收，被收集的区域在图中用红色格子标出。根据年龄，存活对象可能被复制到 Survivor 区域（标有"S"），也可能被复制到年老区域（图中未展示）。图中标有 &ldquo;H&rdquo; 的那些区域包含的是那些大小超过区域的一半或需要特殊对待的大对象。</p><h4 id=浮动垃圾-1>浮动垃圾</h4><p>对象可能在G1回收的过程中死亡并未被回收。为了保证找到所有的存活对象，G1使用了一项叫做 <strong>SATB（snapshot-at-the-beginning）</strong> 的技术。SATB规定：任何在并发标记开始的时候存活的对象在整个 GC 过程中也是被认为是存活的。因此，G1 中也会出现浮动垃圾。</p><h4 id=卡表>卡表</h4><p>如果 GC 不收集整个堆，GC 就必须知道哪里有从堆中未收集部分指向正被收集部分的指针。这在分代 GC 中很典型：未收集部分通常是年老代，正被收集部分是年轻代。<strong>记忆集（remembered set）</strong> 就是保存这些信息（年老代到年轻代的指针）的数据结构。<strong>卡表（card table）</strong> 是记忆集的一种具体实现，HotSpot VM 中用一个字节数组来表示卡表，每一个字节都被称为一张卡，每张卡都对应了堆中的一个地址空间。</p><h2 id=参考资料>参考资料</h2><ol><li><a href=https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/introduction.html target=_blank>Java Platform, Standard Edition HotSpot Virtual Machine Garbage Collection Tuning Guide</a>
.</li></ol></div></article></div><div x-cloak x-data="{ atTop: false }"><button id=scrollToTop name="scroll to top button" aria-label="scroll to top button" class="fixed z-50 w-10 h-10 font-bold text-center text-white transition-all duration-1000 ease-in-out transform bg-violet-600 rounded-full cursor-pointer animate-bounce bottom-24 right-8 focus:outline-none" :class="{ 'opacity-0 translate-y-24': !atTop, 'opacity-1 translate-y-2' :  atTop}" @click="window.scrollTo({ top: 0, behavior: 'smooth'})" @scroll.window="atTop = (window.pageYOffset > 200) ? true : false"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 11l3-3m0 0 3 3m-3-3v8m0-13a9 9 0 110 18 9 9 0 010-18z"/></svg></button></div><footer class=bg-gray-900><div class="max-w-md px-4 py-12 mx-auto overflow-hidden sm:max-w-3xl sm:px-6 lg:max-w-7xl lg:px-8"><nav class="flex flex-wrap justify-center -mx-5 -my-2" aria-label=Footer><div class="px-5 py-2"><a href=https://zhannicholas.github.io/about class="text-base text-gray-400 hover:text-gray-300">About</a></div><div class="px-5 py-2"><a href=https://zhannicholas.github.io/posts/ class="text-base text-gray-400 hover:text-gray-300">Posts</a></div><div class="px-5 py-2"><a href=https://zhannicholas.github.io/notes/ class="text-base text-gray-400 hover:text-gray-300">Notes</a></div><div class="px-5 py-2"><a href=https://zhannicholas.github.io/library/ class="text-base text-gray-400 hover:text-gray-300">Library</a></div><div class="px-5 py-2"><a href=https://zhannicholas.github.io/contact/ class="text-base text-gray-400 hover:text-gray-300">Contact</a></div></nav><div class="flex justify-center mt-2 space-x-6"><a href=https://github.com/zhannicholas class="text-gray-400 hover:text-gray-300"><span class=sr-only>GitHub</span><svg class="w-6 h-6" fill="currentcolor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483.0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951.0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65.0.0.84-.27 2.75 1.026A9.564 9.564.0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688.0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855.0 1.338-.012 2.419-.012 2.747.0.268.18.58.688.482A10.019 10.019.0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"/></svg></a>
<a href=mailto:zhan_nicholas@outlook.com class="text-gray-400 hover:text-gray-300"><span class=sr-only>Email</span><svg class="w-6 h-6" fill="currentcolor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M21 7.38246601V5H3V7.38199365l9.0000224 4.50046115L21 7.38246601zm0 2.23606798-9.0000224 4.50001121L3 9.61810635V19H21V9.61853399zM3 3H21c1.1045695.0 2 .8954305 2 2V19c0 1.1045695-.8954305 2-2 2H3c-1.1045695.0-2-.8954305-2-2V5c0-1.1045695.8954305-2 2-2z" clip-rule="evenodd"/></svg></a>
<a href=https://t.me/zhannicholas class="text-gray-400 hover:text-gray-300"><span class=sr-only>Telegram</span><svg class="w-6 h-6" fill="currentcolor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.78754 14.0196C5.83131 14.0344 5.87549 14.0448 5.91963 14.0512 5.96777 14.1644 6.02996 14.3107 6.10252 14.4818c.17707.4176.41566.9825.66194 1.5717C7.2667 17.2552 7.77332 18.4939 7.88521 18.8485 8.02372 19.2868 8.17013 19.5848 8.32996 19.7883 8.4126 19.8935 8.50819 19.9853 8.62003 20.0549 8.67633 20.0899 8.7358 20.1186 8.79788 20.14 8.80062 20.141 8.80335 20.1419 8.80608 20.1428 9.1261 20.2636 9.41786 20.2133 9.60053 20.1518 9.69827 20.1188 9.77735 20.0791 9.8334 20.0469 9.86198 20.0304 9.88612 20.0151 9.90538 20.0021L9.90992 19.9991l2.82618-1.7625 3.2646 2.5028C16.0488 20.7763 16.1014 20.8073 16.157 20.8316 16.5492 21.0027 16.929 21.0624 17.2862 21.0136 17.6429 20.9649 17.926 20.8151 18.1368 20.6464 18.3432 20.4813 18.4832 20.2963 18.5703 20.1589 18.6148 20.0887 18.6482 20.0266 18.6718 19.9791 18.6836 19.9552 18.6931 19.9346 18.7005 19.9181L18.7099 19.8963 18.7135 19.8877 18.715 19.8841 18.7156 19.8824 18.7163 19.8808C18.7334 19.8379 18.7466 19.7935 18.7556 19.7482L21.7358 4.72274C21.7453 4.67469 21.7501 4.62581 21.7501 4.57682 21.7501 4.13681 21.5843 3.71841 21.1945 3.46452 20.8613 3.24752 20.4901 3.23818 20.2556 3.25598 20.0025 3.27519 19.7688 3.33766 19.612 3.38757 19.5304 3.41355 19.4619 3.43861 19.4126 3.45773 19.3878 3.46734 19.3675 3.47559 19.3523 3.48188L19.341 3.48666 2.62725 10.0432 2.62509 10.044C2.61444 10.0479 2.60076 10.053 2.58451 10.0593 2.55215 10.0719 2.50878 10.0896 2.45813 10.1126 2.35935 10.1574 2.22077 10.2273 2.07856 10.3247c-.22719.1556-.74968.5817-.6617 1.285.07019.5611.45457.9057.68876 1.0714C2.23421 12.7721 2.35638 12.8371 2.44535 12.8795 2.48662 12.8991 2.57232 12.9339 2.6095 12.9491L2.61889 12.9529l3.16865 1.0667zM19.9259 4.86786 19.9236 4.86888C19.9152 4.8725 19.9069 4.87596 19.8984 4.87928L3.1644 11.4438C3.15566 11.4472 3.14686 11.4505 3.138 11.4536L3.12869 11.4571C3.11798 11.4613 3.09996 11.4686 3.07734 11.4788 3.06451 11.4846 3.05112 11.491 3.03747 11.4978 3.05622 11.5084 3.07417 11.5175 3.09012 11.5251 3.10543 11.5324 3.11711 11.5374 3.1235 11.54l3.14263 1.058C6.32365 12.6174 6.37727 12.643 6.42649 12.674L16.8033 6.59948 16.813 6.59374C16.8205 6.58927 16.8305 6.58353 16.8424 6.5768 16.866 6.56345 16.8984 6.54568 16.937 6.52603 17.009 6.48938 17.1243 6.43497 17.2541 6.39485 17.3444 6.36692 17.6109 6.28823 17.899 6.38064 18.0768 6.43767 18.2609 6.56028 18.3807 6.76798 18.4401 6.87117 18.4718 6.97483 18.4872 7.06972 18.528 7.2192 18.5215 7.36681 18.4896 7.49424 18.4208 7.76875 18.228 7.98287 18.0525 8.14665 17.9021 8.28706 15.9567 10.1629 14.0376 12.0147 13.0805 12.9381 12.1333 13.8525 11.4252 14.5359l-.465.449 5.8719 4.5018C16.9668 19.5349 17.0464 19.5325 17.0832 19.5274 17.1271 19.5214 17.163 19.5045 17.1997 19.4752 17.2407 19.4424 17.2766 19.398 17.3034 19.3557L17.3045 19.354 20.195 4.78102C20.1521 4.79133 20.1087 4.80361 20.0669 4.81691 20.0196 4.83198 19.9805 4.84634 19.9547 4.85637 19.9418 4.86134 19.9326 4.86511 19.9276 4.86719L19.9259 4.86786zM11.4646 17.2618 10.2931 16.3636 10.0093 18.1693 11.4646 17.2618zM9.21846 14.5814l1.16494-1.1247c.7081-.6835 1.6555-1.5979 2.6127-2.5215l.9725-.9382-6.52007 3.8168L7.48351 13.8963c.1777.4191.41736.9864.664940000000001 1.5788.185129999999999.4429.37872.9093.55504 1.3411l.28304-1.8004C9.01381 14.8422 9.09861 14.692 9.21846 14.5814z" clip-rule="evenodd"/></svg></a></div><p class="mt-2 text-base text-center text-gray-400">2018-2023 &copy; Nicholas Zhan. Licensed under <a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/>CC BY-NC 4.0</a>.</p></div></footer><script type=text/javascript src=https://zhannicholas.github.io/js/app.min.5ce6717c9c557de80f2d726a4693ef2581084ac7685dfb48c6a73140cf8a6bbd5bd8f76b0dbfe285737c83b968be59d2db22198e4e39d5b0bc42e7571630c4b1.js integrity="sha512-XOZxfJxVfegPLXJqRpPvJYEISsdoXftIxqcxQM+Ka71b2PdrDb/ihXN8g7lovlnS2yIZjk451bC8QudXFjDEsQ=="></script></body></html>